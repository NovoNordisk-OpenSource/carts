<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation-Based Assessment of Covariate Adjustment in Randomized Trials • carts</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation-Based Assessment of Covariate Adjustment in Randomized Trials">
<meta name="description" content="Monte Carlo simulation framework for different randomized clinical trial designs with a special emphasis on estimators based on covariate adjustment.">
<meta property="og:description" content="Monte Carlo simulation framework for different randomized clinical trial designs with a special emphasis on estimators based on covariate adjustment.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">carts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/gettingstarted.html">Getting started</a></li>
    <li><a class="dropdown-item" href="articles/param.html">Parametrization of the negative binomial and gamma distribution</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NovoNordisk-OpenSource/carts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="carts-package">carts package<a class="anchor" aria-label="anchor" href="#carts-package"></a>
</h1></div>
<p>The <code>carts</code> R package is a simulation tool for exploring various estimators within a clinical trial context under differing assumptions. The package provides a user-friendly interface for defining a clinical trial object with different choices for its design, patient and endpoint distributions, and treatment effect estimators. Once a clinical trial object is specified, the package provides the functionality for estimating the power with Monte Carlo simulations.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Here we emulate a simple parallel trial design with both observed and unobserved covariates. The treatment effect is estimated using an estimator based on the efficient influence function (EIF) where we adjust for the observed covariate x.</p>
<p>The necessary sample-size to achieve 90% power for a one-sided superiority test is estimated using a variation of a bisection and a Robbins-Monro stochastic approximation algorithm with parallelized computations</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"carts"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## Loading required package: lava</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"data.table"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(future<span class="sc">::</span>multicore)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">## progressr::handlers(global = TRUE)</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="do">## progressr::handlers(progressr::handler_cli)</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="do">## Covariates at baseline</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">pa =</span> <span class="fl">0.5</span>, <span class="at">gamma.var =</span> <span class="fl">0.7</span>, ...) {</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="fu">data.table</span>(</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    <span class="at">a =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, pa), <span class="do">## Treatment</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(n), <span class="do">## Obs.</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">log</span>(<span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">1</span> <span class="sc">/</span> gamma.var, <span class="at">rate =</span> <span class="dv">1</span> <span class="sc">/</span> gamma.var)) <span class="do">## Unobs.</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  )</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="do">## Outcome model</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">b =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">2.5</span>), <span class="fu">log</span>(<span class="fl">0.38</span>)), ...) {</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> a, data)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> <span class="fu">exp</span>(X <span class="sc">%*%</span> b <span class="sc">+</span> <span class="fu">with</span>(data, x <span class="sc">+</span> z))</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="fu">data.table</span>(<span class="at">y =</span> <span class="fu">rpois</span>(<span class="fu">length</span>(rate), rate))</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>}</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>qmodel  <span class="ot">&lt;-</span> targeted<span class="sc">::</span><span class="fu">learner_glm</span>(y <span class="sc">~</span> a <span class="sc">*</span> x, <span class="at">family =</span> poisson)</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>m <span class="ot">&lt;-</span> Trial<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  <span class="at">covariates =</span> x0,</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  <span class="at">outcome =</span> outcome,</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>  <span class="at">estimators =</span> <span class="fu">list</span>(<span class="at">adj =</span> <span class="fu">est_adj</span>(qmodel))</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>  )</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="do">## Sample-size estimation via Stochastic Approximation</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>e <span class="ot">&lt;-</span> m<span class="sc">$</span><span class="fu">estimate_samplesize</span>(<span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="fu">print</span>(e)</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="do">## ── Estimated sample-size to reach 90% power ── </span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="do">## n = 98 (actual estimated power≈91.18%)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed on all unix systems from the command line via <code>make install</code>. Already installed R packages that are dependencies of <code>carts</code> will not be upgrade with <code>make install</code>. Instead, use the <code>make upgrade</code> rule to upgrade all dependencies, followed by the installation of the package.</p>
</div>
<div class="section level2">
<h2 id="project-organization">Project organization<a class="anchor" aria-label="anchor" href="#project-organization"></a>
</h2>
<p>We use the <code>dev</code> branch for development and the <code>main</code> branch for stable releases. All releases follow <a href="https://semver.org/" class="external-link">semantic versioning</a>, are <a href="https://github.com/NovoNordisk-OpenSource/carts/tags" class="external-link">tagged</a> and notable changes are reported in the <a href="https://github.com/NovoNordisk-OpenSource/carts/blob/main/NEWS.md" class="external-link">NEWS.md</a> file.</p>
</div>
<div class="section level2">
<h2 id="i-have-a-question--i-want-to-report-a-bug">I Have a Question / I Want to Report a Bug<a class="anchor" aria-label="anchor" href="#i-have-a-question--i-want-to-report-a-bug"></a>
</h2>
<p>If you want to ask questions, require help or clarification, or report a bug, we recommend to either contact a maintainer directly or the following:</p>
<ul>
<li>Open an <a href="https://github.com/NovoNordisk-OpenSource/carts/issues" class="external-link">Issue</a>.</li>
<li>Provide as much context as you can about what you’re running into.</li>
<li>Provide project and platform versions, depending on what seems relevant.</li>
</ul>
<p>We will then take care of the issue as soon as possible.</p>
</div>
<div class="section level2">
<h2 id="maintainers">Maintainers<a class="anchor" aria-label="anchor" href="#maintainers"></a>
</h2>
<blockquote>
<p>Benedikt Sommer (<a href="mailto:benediktsommer92@gmail.com" class="email">benediktsommer92@gmail.com</a>)<br>
Klaus Kähler Holst (<a href="mailto:klaus@holst.it" class="email">klaus@holst.it</a>)</p>
</blockquote>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NovoNordisk-OpenSource/carts/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/NovoNordisk-OpenSource/carts/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing carts</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Benedikt Sommer <br><small class="roles"> Author, maintainer </small>   </li>
<li>Klaus K. Holst <br><small class="roles"> Author </small>   </li>
<li>Foroogh Shamsi <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/r-cmd-check.yaml" class="external-link"><img src="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/r-cmd-check.yaml/badge.svg" alt="complete-checks"></a></li>
<li><a href="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/vignettes.yaml" class="external-link"><img src="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/vignettes.yaml/badge.svg" alt="vignettes"></a></li>
<li><a href="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/slow-tests.yaml" class="external-link"><img src="https://github.com/NovoNordisk-OpenSource/carts/actions/workflows/slow-tests.yaml/badge.svg" alt="slowtests"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benedikt Sommer, Klaus K. Holst, Foroogh Shamsi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
