<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>R6 class for power and sample-size calculations for a clinical trial — Trial • carts</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R6 class for power and sample-size calculations for a clinical trial — Trial"><meta name="description" content="Simulation of RCT with flexible covariates distributions
simulation."><meta property="og:description" content="Simulation of RCT with flexible covariates distributions
simulation."><meta property="og:image" content="https://novonordisk-opensource.github.io/carts/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">carts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gettingstarted.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/param.html">Parametrization of the negative binomial and gamma distribution</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NovoNordisk-OpenSource/carts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>R6 class for power and sample-size calculations for a clinical trial</h1>
      <small class="dont-index">Source: <a href="https://github.com/NovoNordisk-OpenSource/carts/blob/main/R/Trial.R" class="external-link"><code>R/Trial.R</code></a></small>
      <div class="d-none name"><code>Trial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulation of RCT with flexible covariates distributions
simulation.</p>
    </div>


    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Kähler Holst, Benedikt Sommer</p>
<p>Benedikt Sommer</p>
<p>Klaus Kähler Holst</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>info</code></dt>
<dd><p>Optional information/name of the model</p></dd>


<dt><code>covariates</code></dt>
<dd><p>covariate generator
(function of sample-size n and optional parameters)</p></dd>


<dt><code>outcome_model</code></dt>
<dd><p>Generator for outcome given covariates
(function of covariates x in long format)</p></dd>


<dt><code>exclusion</code></dt>
<dd><p>function defining exclusion criterion</p></dd>


<dt><code>estimates</code></dt>
<dd><p>(<a href="trial.estimates-class.html">trial.estimates</a>) Parameter estimates of
Monte-Carlo simulations returned by Trial$run(). The field is
flushed, i.e. set to its default value <em>NULL</em>, when model arguments
(Trial$args_model()) or estimators (Trial$estimators())
are modified.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Trial-new"><code>Trial$new()</code></a></p></li>
<li><p><a href="#method-Trial-args_model"><code>Trial$args_model()</code></a></p></li>
<li><p><a href="#method-Trial-args_summary"><code>Trial$args_summary()</code></a></p></li>
<li><p><a href="#method-Trial-estimators"><code>Trial$estimators()</code></a></p></li>
<li><p><a href="#method-Trial-simulate"><code>Trial$simulate()</code></a></p></li>
<li><p><a href="#method-Trial-run"><code>Trial$run()</code></a></p></li>
<li><p><a href="#method-Trial-estimate_power"><code>Trial$estimate_power()</code></a></p></li>
<li><p><a href="#method-Trial-estimate_samplesize"><code>Trial$estimate_samplesize()</code></a></p></li>
<li><p><a href="#method-Trial-summary"><code>Trial$summary()</code></a></p></li>
<li><p><a href="#method-Trial-print"><code>Trial$print()</code></a></p></li>
<li><p><a href="#method-Trial-clone"><code>Trial$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Trial-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialize new Trial object</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">outcome</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclusion <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  summary.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  info <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>outcome</code></dt>
<dd><p>outcome model given covariates
(the first positional argument must be the covariate data)</p></dd>


<dt><code>covariates</code></dt>
<dd><p>covariate simulation function (must have 'n' as first
named argument and returns either a list of data.table (data.frame) for
each observation period or a single data.table (data.frame) in case of a
single observation period)</p></dd>


<dt><code>exclusion</code></dt>
<dd><p>function describing selection criterion (the first
positional argument must be the combined covariate and outcome data and
the function must return the subjects who are included in the trial)</p></dd>


<dt><code>estimators</code></dt>
<dd><p>optional list of estimators or single estimator
function</p></dd>


<dt><code>summary.args</code></dt>
<dd><p>list of arguments that override default values in
Trial$summary() when power and sample sizes are
estimated with Trial$estimate_power() and
Trial$estimate_samplesize()</p></dd>


<dt><code>info</code></dt>
<dd><p>optional string describing the model</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-args_model"></a><div class="section">
<h3 id="method-args-model-">Method <code>args_model()</code><a class="anchor" aria-label="anchor" href="#method-args-model-"></a></h3>
<p>Get, specify or update parameters of covariate, outcome and
exclusion model. Parameters are set in a named list, and updated when
parameter names match with existing values in the list.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.args <span class="op">=</span> <span class="cn">NULL</span>, .reset <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>.args</code></dt>
<dd><p>(list or character) named list of arguments to update
or set. A single or subset of arguments can be retrieved by passing the
respective argument names as a character or character vector.</p></dd>


<dt><code>.reset</code></dt>
<dd><p>(logical or character) Reset all or a subset of previously
set parameters. Can be combined with setting new parameters.</p></dd>


<dt><code>...</code></dt>
<dd><p>Alternative to using <code>.args</code> to update or set arguments</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">ate</span>, <span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set and update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">0.5</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="co"># update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># combine first arg with ...</span></span>
<span></span>
<span><span class="co"># retrieve parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="op">)</span> <span class="co"># return all set parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="st">"ate"</span><span class="op">)</span> <span class="co"># select a single parameter</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ate"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span> <span class="co"># multiple parameters</span></span>
<span></span>
<span><span class="co"># remove parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"ate"</span><span class="op">)</span> <span class="co"># remove a single parameter</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all parameters</span></span>
<span></span>
<span><span class="co"># remove and set/update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">0.5</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">5</span>, .reset <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span> <span class="co"># removing p and updating ate</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-args_summary"></a><div class="section">
<h3 id="method-args-summary-">Method <code>args_summary()</code><a class="anchor" aria-label="anchor" href="#method-args-summary-"></a></h3>
<p>Get, specify or update the summary.args attribute.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>.args <span class="op">=</span> <span class="cn">NULL</span>, .reset <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>.args</code></dt>
<dd><p>(list or character) named list of arguments to update
or set. A single or subset of arguments can be retrieved by passing the
respective argument names as a character or character vector.</p></dd>


<dt><code>.reset</code></dt>
<dd><p>(logical or character) Reset all or a subset of previously
set parameters. Can be combined with setting new parameters.</p></dd>


<dt><code>...</code></dt>
<dd><p>Alternative to using <code>.args</code> to update or set arguments</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">ate</span>, <span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># set and update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="co"># update parameters</span></span>
<span></span>
<span><span class="co"># retrieve parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="op">)</span> <span class="co"># return all set parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="st">"level"</span><span class="op">)</span> <span class="co"># select a single parameter</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="st">"alternative"</span><span class="op">)</span><span class="op">)</span> <span class="co"># multiple parameters</span></span>
<span></span>
<span><span class="co"># remove parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="co"># remove a single parameter</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all parameters</span></span>
<span></span>
<span><span class="co"># remove and set/update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"!="</span>, level <span class="op">=</span> <span class="fl">0.05</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># removing alternative and setting level</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, .reset <span class="op">=</span> <span class="st">"alternative"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-estimators"></a><div class="section">
<h3 id="method-estimators-">Method <code>estimators()</code><a class="anchor" aria-label="anchor" href="#method-estimators-"></a></h3>
<p>Get, specify or update estimators.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.estimators <span class="op">=</span> <span class="cn">NULL</span>, .reset <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>.estimators</code></dt>
<dd><p>(list, function or character) Argument controlling
the getter or setter behavior. Estimators are set or updated by providing
a single estimator (function) or list of estimators, and retrieved by
providing a character (see examples).</p></dd>


<dt><code>.reset</code></dt>
<dd><p>(logical or character) Reset all or a subset of previously
set estimators. Can be combined with setting new estimators.</p></dd>


<dt><code>...</code></dt>
<dd><p>Alternative to <code>.estimators</code> for updating or setting
estimators.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>A name is internally assigned to estimators when calling the
method with <code>.estimators</code> set to a single estimator or a list with
unnamed elements. The names are a combination of an <em>est</em> prefix and an
integer that indicates the <em>n</em>th added unnamed estimator.</p>
</div>

<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">estimators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marginal <span class="op">=</span> <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span>,</span>
<span>  estimators <span class="op">=</span> <span class="va">estimators</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get estimators</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># list all estimators</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="st">"marginal"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># select a single estimator</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marginal"</span>, <span class="st">"adj"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># select mult. est.</span></span>
<span></span>
<span><span class="co"># remove estimators</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span> <span class="co"># remove a single estimator</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all estimators</span></span>
<span></span>
<span><span class="co"># set or update estimators</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="va">estimators</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>adj2 <span class="op">=</span> <span class="fu"><a href="../reference/est_adj.html">est_adj</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span> <span class="co"># add new estimator</span></span>
<span><span class="co"># update adj and remove adj2</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>adj <span class="op">=</span> <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>, .reset <span class="op">=</span> <span class="st">"adj2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># unnamed estimators (adding default name)</span></span>
<span><span class="va">estimators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="va">estimators</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"est1"</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># replaces removed est1</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-simulate"></a><div class="section">
<h3 id="method-simulate-">Method <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate()</a></code><a class="anchor" aria-label="anchor" href="#method-simulate-"></a></h3>
<p>Simulate data by applying parameters to the trial model. The
method samples first from the covariate model. Outcome data sampling
follows by passing the simulated covariate data to the outcome model. An
optional exclusion model is applied to the combined covariates and
outcomes data. The sampling process is repeated in case any subjects are
removed by the exclusion model until a total of <code>n</code> subjects are sampled
or the maximum iteration number <code>.niter</code> is reached.</p>
<p>The method adds two auxiliary columns to the simulated data to identify
distinct patients (<em>id</em>) and periods (<em>num</em>) in case of time-dependent
covariate and outcome models. The columns are added to the sampled
covariate data before sampling the outcomes. A <em>data.table</em> with both
columns is provided to the outcome model in case no covariate model is
defined. Thus, the outcome model is always applied to at least a
<em>data.table</em> with an <em>id</em> and <em>num</em> column. The default column name <em>y</em>
is used for the outcome variable in the returned <em>data.table</em> when the
defined outcome model returns a vector. The name is easily changed by
returning a <em>data.table</em> with a named column (see examples).</p>
<p>The optional argument <code>...</code> of this method can be used to provide
parameters to the trial model as an addition to parameters that have
already been defined via Trial$args_model(). Data is simulated
from the union of parameters, where parameters provided via the optional
argument of this method take precedence over parameters defined via
Trial$args_model(). However, parameters that have been set via
Trial$args_model() are not updated when optional arguments are
provided.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span>, .niter <span class="op">=</span> <span class="fl">500L</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>(integer) Number of observations (sample size)</p></dd>


<dt><code>.niter</code></dt>
<dd><p>(integer) Maximum number of simulation runs to avoid
infinite loops for ill defined exclusion functions.</p></dd>


<dt><code>...</code></dt>
<dd><p>Arguments to covariate, outcome and exclusion model
functions</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>data.table with <code>n</code> rows</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># applying and modifying parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># use parameters set during initialization</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span> <span class="co"># update parameters</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span>, ate <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># change ate via optional argument</span></span>
<span></span>
<span><span class="co"># rename outcome variable</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>yy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># return multiple outcome variables</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, y.base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, y.chg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y.base</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use exclusion argument to post-process sampled outcome variable to</span></span>
<span><span class="co"># achieve the same as in the above example but without modifying the</span></span>
<span><span class="co"># originally defined outcome model</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, y.base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  exclusion <span class="op">=</span> \<span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y.chg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y.base</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># no covariate model</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-run"></a><div class="section">
<h3 id="method-run-">Method <code>run()</code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>Run trial and estimate parameters multiple times</p>
<p>The method calls Trial$simulate() <code>R</code> times and applies the
specified estimators to each simulated dataset of sample size <code>n</code>.
Parameters to the covariates, outcome and exclusion models can be
provided as optional arguments to this method call in addition to
parameters that have already been defined via
Trial$args_model(). The behavior is identical to
Trial$simulate(), except that <code>.niter</code> can be provided as an
optional argument to this method for controlling the maximum number of
simulation runs in Trial$simulate().</p>
<p>Estimators fail silently in that errors occurring when applying an
estimator to each simulated dataset will not terminate the method call.
The returned <a href="trial.estimates-class.html">trial.estimates</a> object will instead indicate that
estimators failed.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">n</span>, R <span class="op">=</span> <span class="fl">100</span>, estimators <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>(integer) Number of observations (sample size)</p></dd>


<dt><code>R</code></dt>
<dd><p>(integer) Number of replications</p></dd>


<dt><code>estimators</code></dt>
<dd><p>(list or function) List of estimators or a single unnamed
estimator</p></dd>


<dt><code>...</code></dt>
<dd><p>Arguments to covariate, outcome and exclusion model
functions</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>(invisible) An object of class <a href="trial.estimates-class.html">trial.estimates</a>, which
contains the estimates of all estimators and all information to repeat
the simulation. The return object is also assigned to the <code>estimates</code>
field of this Trial class object (see examples).</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{ # don't run because of high computational time
# future::plan("multicore")
trial &lt;- Trial$new(
  covariates = \(n) data.frame(a = rbinom(n, 1, 0.5)),
  outcome = \(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),
  estimators = list(glm = est_glm())
)
trial$args_summary(alternative = "&lt;")

# the returned trial.estimates object contains the estimates for each of
# the R simulated data sets + all necessary information to re-run the
# simulation
res &lt;- trial$run(n = 100, R = 50) # store return object in a new variable
print(trial$estimates) # trial$estimates == res

# the basic usage is to apply the summary method to the generated
# trial.estimates object.
trial$summary()

# combining Trial$run and summary is faster than using
# Trial$estimate_power when modifying only the parameters of the
# decision-making function
sapply(
  c(0, 0.25, 0.5),
  \(ni) trial$summary(ni.margin = ni)[, "power"]
)

# changing the ate parameter value
trial$run(n = 100, R = 50, ate = -0.2)

# supplying another estimator
trial$run(n = 100, R = 50, estimators = est_glm(robust = FALSE))
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-estimate_power"></a><div class="section">
<h3 id="method-estimate-power-">Method <code>estimate_power()</code><a class="anchor" aria-label="anchor" href="#method-estimate-power-"></a></h3>
<p>Estimates statistical power for a specified trial</p>
<p>Convenience method that first runs Trial$run() and subsequently
applies Trial$summary() to derive the power for each
estimator. The behavior of passing arguments to lower level functions is
identical to Trial$run().</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">estimate_power</span><span class="op">(</span><span class="va">n</span>, R <span class="op">=</span> <span class="fl">100</span>, estimators <span class="op">=</span> <span class="cn">NULL</span>, summary.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>(integer) Number of observations (sample size)</p></dd>


<dt><code>R</code></dt>
<dd><p>(integer) Number of replications</p></dd>


<dt><code>estimators</code></dt>
<dd><p>(list or function) List of estimators or a single unnamed
estimator</p></dd>


<dt><code>summary.args</code></dt>
<dd><p>(list) Arguments passed to summary method
for decision-making</p></dd>


<dt><code>...</code></dt>
<dd><p>Arguments to covariate, outcome and exclusion model
functions</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>numeric</p>
</div>
<div class="section">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{ # don't run because of high computational time
# toy examples with small number of Monte-Carlo replicates
# future::plan("multicore")
trial &lt;- Trial$new(
  covariates = \(n) data.frame(a = rbinom(n, 1, 0.5)),
  outcome = \(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),
  estimators = list(glm = est_glm())
)
trial$args_summary(alternative = "&lt;")

# using previously defined estimators and summary.args
trial$estimate_power(n = 100, R = 20)

# supplying parameters to outcome function
trial$estimate_power(n = 100, R = 20, ate = -100)

# modifying arguments of summary function
trial$estimate_power(n = 100, R = 20, ate = -100,
 summary.args = list(alternative = "&gt;")
)

# supplying estimators to overrule previously set estimators
trial$estimate_power(n = 100, R = 20,
 estimators = list(est_glm(), est_adj()))
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-estimate_samplesize"></a><div class="section">
<h3 id="method-estimate-samplesize-">Method <code>estimate_samplesize()</code><a class="anchor" aria-label="anchor" href="#method-estimate-samplesize-"></a></h3>
<p>Estimate the minimum sample-size required to reach a desired
statistical power with a specified estimator. An initial rough estimate
is obtained via bisection, followed by a
stochastic approximation (Robbins-Monro) algorithm, and finally, a grid
search (refinement step) in the neighbourhood of the current best
solution.</p>
<p>Note that the estimation procedure for the sample size will not populate
the estimates attribute of a trial object.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">estimate_samplesize</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  estimator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50L</span>, <span class="fl">10000L</span><span class="op">)</span>,</span>
<span>  bisection.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">100</span>, niter <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  sa.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1</span>, niter <span class="op">=</span> <span class="fl">250</span>, stepmult <span class="op">=</span> <span class="fl">100</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  refinement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  interpolate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  minimum <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  summary.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to covariate, outcome and exclusion model
functions</p></dd>


<dt><code>power</code></dt>
<dd><p>(numeric) Desired statistical power</p></dd>


<dt><code>estimator</code></dt>
<dd><p>(list or function) Estimator (function) to be applied.
If NULL, then estimate sample size for all estimators defined via
Trial$estimators(). A prefix <em>est</em> is used to label unnamed
estimators.</p></dd>


<dt><code>interval</code></dt>
<dd><p>(integer vector) Interval in which to initially look for
a solution with the bisection algorithm. Passing an integer will skip the
bisection algorithm and use the provided integer as the initial solution
for the stochastic approximation algorithm</p></dd>


<dt><code>bisection.control</code></dt>
<dd><p>(list) Options controlling the bisection
algorithm (<a href="bisection.html">bisection</a>). Default values can also be changed for a
subset of options only (see examples).</p></dd>


<dt><code>sa.control</code></dt>
<dd><p>(list) Options controlling the stochastic approximation
(Robbins-Monro) algorithm (<a href="optim_sa.html">optim_sa</a>). Default values can also be
changed for a subset of options only (see examples).</p></dd>


<dt><code>refinement</code></dt>
<dd><p>(integer vector) Vector to create an interval whose
center is the sample size estimate of the Robbins-Monro algorithm.</p></dd>


<dt><code>R</code></dt>
<dd><p>(integer) Number of replications to use in Monte Carlo
simulation of refinement calculations.</p></dd>


<dt><code>interpolate</code></dt>
<dd><p>(logical) If TRUE, a linear interpolation of the
refinement points will be used to estimate the power.</p></dd>


<dt><code>verbose</code></dt>
<dd><p>(logical) If TRUE, additional output will be displayed.</p></dd>


<dt><code>minimum</code></dt>
<dd><p>(integer) Minimum sample size.</p></dd>


<dt><code>summary.args</code></dt>
<dd><p>(list) Arguments passed to summary method
for decision-making</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>samplesize_estimate S3 object</p>
</div>
<div class="section">
<h4 id="examples-6">Examples<a class="anchor" aria-label="anchor" href="#examples-6"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{ # don't run because of high computational time
trial &lt;- Trial$new(
  covariates = \(n) data.frame(a = rbinom(n, 1, 0.5)),
  outcome = \(data, ate, sd) with(data, rnorm(nrow(data), a * ate, sd)),
  estimators = list(marginal = est_glm())
)
trial$args_model(ate = -1, sd = 5)
trial$args_summary(alternative = "&lt;")

# supply model parameter and estimator to call to overwrite previously
# set values
trial$estimate_samplesize(ate = -2, estimator = est_glm())

# reduce number of iterations for bisection step but keep R = 100
# (default value)
# trial$estimate_samplesize(bisection.control = list(niter = 2))

# reduce significance level from 0.05 to 0.025, but keep alternative as
# before
# trial$estimate_samplesize(summary.args = list(level = 0.025))
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-summary"></a><div class="section">
<h3 id="method-summary-">Method <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code><a class="anchor" aria-label="anchor" href="#method-summary-"></a></h3>
<p>Summarize Monte Carlo studies of different estimators for
the treatment effect in a randomized clinical trial. The method reports
the power of both superiority tests (one-sided or two-sided) and
non-inferiority tests, together with summary statistics of the
different estimators.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span></span>
<span>  level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  null <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ni.margin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"!="</span>,</span>
<span>  reject.function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  true.value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nominal.coverage <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  estimates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>level</code></dt>
<dd><p>(numeric) significance level</p></dd>


<dt><code>null</code></dt>
<dd><p>(numeric) null hypothesis to test</p></dd>


<dt><code>ni.margin</code></dt>
<dd><p>(numeric) non-inferiority margin</p></dd>


<dt><code>alternative</code></dt>
<dd><p>alternative hypothesis (not equal !=, less &lt;,
greater &gt;)</p></dd>


<dt><code>reject.function</code></dt>
<dd><p>Optional function calculating whether to reject
the null hypothesis</p></dd>


<dt><code>true.value</code></dt>
<dd><p>Optional true parameter value</p></dd>


<dt><code>nominal.coverage</code></dt>
<dd><p>Width of confidence limits</p></dd>


<dt><code>estimates</code></dt>
<dd><p>Optional trial.estimates object. When provided, these
estimates will be used instead of the object's stored estimates. This
allows calculating summaries for different trial results without
modifying the object's state.</p></dd>


<dt><code>...</code></dt>
<dd><p>additional arguments to lower level functions</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>matrix with results of each estimator stored in separate rows</p>
</div>
<div class="section">
<h4 id="examples-7">Examples<a class="anchor" aria-label="anchor" href="#examples-7"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">outcome</span>, estimators <span class="op">=</span> <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># two-sided test with 0.05 significance level (alpha = 0.05) (default</span></span>
<span><span class="co"># values)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, alternative <span class="op">=</span> <span class="st">"!="</span><span class="op">)</span></span>
<span><span class="co"># on-sided test</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span>, alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span>
<span><span class="co"># non-inferiority test</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span>, ni.margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># provide simulation results to summary method via estimates argument</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate empirical bias, rmse and coverage for true target parameter</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">res</span>, true.value <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Print method for Trial objects</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Additional arguments to lower level functions (not used).</p></dd>


<dt><code>verbose</code></dt>
<dd><p>(logical) By default, only print the
function arguments of the covariates, outcome and exclusion models. If
<em>TRUE</em>, then also print the function body.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="examples-8">Examples<a class="anchor" aria-label="anchor" href="#examples-8"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marginal <span class="op">=</span> <span class="fu"><a href="../reference/est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  info <span class="op">=</span> <span class="st">"Some trial info"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trial</span><span class="op">)</span> <span class="co"># only function headers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trial</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># also print function bodies</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># don't run because of high computational time</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="fu"><a href="setargs.html">setargs</a></span><span class="op">(</span><span class="va">outcome_count</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, overdispersion <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span></span></span>
<span class="r-in"><span>  unadjusted <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  adjusted <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span>, covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'trial' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'trial' not found</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'trial' not found</span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$args_model`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">ate</span>, <span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set and update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">0.5</span>, mu <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="co"># update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># combine first arg with ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># retrieve parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="op">)</span> <span class="co"># return all set parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="st">"ate"</span><span class="op">)</span> <span class="co"># select a single parameter</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ate"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">)</span> <span class="co"># multiple parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"ate"</span><span class="op">)</span> <span class="co"># remove a single parameter</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all parameters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove and set/update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">0.5</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="fl">5</span>, .reset <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span> <span class="co"># removing p and updating ate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$args_summary`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">ate</span>, <span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># set and update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="co"># update parameters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># retrieve parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="op">)</span> <span class="co"># return all set parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ni.margin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $reject.function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $true.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nominal.coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="st">"level"</span><span class="op">)</span> <span class="co"># select a single parameter</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="st">"alternative"</span><span class="op">)</span><span class="op">)</span> <span class="co"># multiple parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="co"># remove a single parameter</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all parameters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove and set/update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"!="</span>, level <span class="op">=</span> <span class="fl">0.05</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># removing alternative and setting level</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, .reset <span class="op">=</span> <span class="st">"alternative"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$estimators`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marginal <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimators <span class="op">=</span> <span class="va">estimators</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get estimators</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># list all estimators</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "marginal" "adj"     </span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="st">"marginal"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># select a single estimator</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"marginal"</span>, <span class="st">"adj"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># select mult. est.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "marginal" "adj"     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove estimators</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span> <span class="co"># remove a single estimator</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># remove all estimators</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set or update estimators</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="va">estimators</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>adj2 <span class="op">=</span> <span class="fu"><a href="est_adj.html">est_adj</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span> <span class="co"># add new estimator</span></span></span>
<span class="r-in"><span><span class="co"># update adj and remove adj2</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>adj <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>, .reset <span class="op">=</span> <span class="st">"adj2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># unnamed estimators (adding default name)</span></span></span>
<span class="r-in"><span><span class="va">estimators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>covariates <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="va">estimators</span>, .reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span>.reset <span class="op">=</span> <span class="st">"est1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimators</span><span class="op">(</span><span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># replaces removed est1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$simulate`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># applying and modifying parameters</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># use parameters set during initialization</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a   num          y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt; &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     1     0 -1.8218177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     0     0 -0.2473253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     0     0 -0.2441996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     0     0 -0.2827054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     0     0 -0.5536994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     0     0  0.6289820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     1     0  2.0650249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     1     0 -1.6309894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     1     0  0.5124269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     0     0 -1.8630115</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span> <span class="co"># update parameters</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a   num             y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt; &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     0     0    0.36295126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     1     0 -101.30454355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     0     0    0.73777632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     0     0    1.88850493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     1     0 -100.09744510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     1     0 -100.93584735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     0     0   -0.01595031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     0     0   -0.82678895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     1     0 -101.51239965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     0     0    0.93536319</span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span>, ate <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># change ate via optional argument</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a   num           y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt; &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     1     0  98.0899125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     0     0  -0.2792372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     1     0  99.6865540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     0     0   1.0673079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     1     0 100.0700349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     1     0  99.3608767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     1     0  99.9500351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     0     0  -0.2514834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     0     0   0.4447971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     0     0   2.7554176</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rename outcome variable</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>yy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a   num          yy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt; &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     1     0 -0.24323674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     1     0 -0.20608719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     1     0  0.01917759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     0     0  0.02956075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     1     0  0.54982754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     1     0 -2.27411486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     0     0  2.68255718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     0     0 -0.36122126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     1     0  0.21335575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     1     0  1.07434588</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># return multiple outcome variables</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, y.base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">y</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, y.chg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y.base</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a     y.base   num           y      y.chg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt;      &lt;num&gt; &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     0  1.0650573     0  0.60674805  0.4583093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     1  0.1316706     0 -0.10993567  0.2416063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     1  0.4886288     0  0.17218172  0.3164471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     0 -1.6994506     0 -0.09032729 -1.6091233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     0 -1.4707363     0  1.92434334 -3.3950796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     1  0.2841503     0  1.29839276 -1.0142424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     0  1.3373204     0  0.74879127  0.5885291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     0  0.2366963     0  0.55622433 -0.3195280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     0  1.3182934     0 -0.54825726  1.8665506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     1  0.5239098     0  1.11053489 -0.5866251</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use exclusion argument to post-process sampled outcome variable to</span></span></span>
<span class="r-in"><span><span class="co"># achieve the same as in the above example but without modifying the</span></span></span>
<span class="r-in"><span><span class="co"># originally defined outcome model</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, y.base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  exclusion <span class="op">=</span> \<span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y.chg <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y.base</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a      y.base   num          y      y.chg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt;       &lt;num&gt; &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     0  1.06310200     0 -0.7854327  1.8485347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     1  1.04871262     0 -1.0567369  2.1054495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     0 -0.03810289     0 -0.7955414  0.7574385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     1  0.48614892     0 -1.7562754  2.2424243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     1  1.67288261     0 -0.6905379  2.3634205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     0 -0.35436116     0 -0.5585420  0.2041808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     0  0.94634789     0 -0.5366633  1.4830112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     1  1.31682636     0  0.2271271  1.0896992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     1 -0.29664002     0  0.9784549 -1.2750949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     0 -0.38721358     0 -0.2088827 -0.1783309</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># no covariate model</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id     a           y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt; &lt;int&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     1     0  0.42485844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     2     1 -1.68428153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     3     1  0.24940178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     4     1  1.07283825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     5     0  2.03936926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     6     1  0.44945378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     7     1  1.39181405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     8     1  0.42656655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     9     1  0.10758399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    10     0  0.02229473</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$run`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># don't run because of high computational time</span></span></span>
<span class="r-in"><span><span class="co"># future::plan("multicore")</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>glm <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the returned trial.estimates object contains the estimates for each of</span></span></span>
<span class="r-in"><span><span class="co"># the R simulated data sets + all necessary information to re-run the</span></span></span>
<span class="r-in"><span><span class="co"># simulation</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># store return object in a new variable</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in names(estimators) &lt;- paste0("est", seq_along(estimators)):</span> 'names' attribute [1] must be the same length as the vector [0]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trial</span><span class="op">$</span><span class="va">estimates</span><span class="op">)</span> <span class="co"># trial$estimates == res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the basic usage is to apply the summary method to the generated</span></span></span>
<span class="r-in"><span><span class="co"># trial.estimates object.</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in trial_summary(self = self, level = level, null = null, ni.margin = ni.margin,     alternative = alternative, reject.function = reject.function,     true.value = true.value, nominal.coverage = nominal.coverage,     estimates = estimates, ...):</span> No estimates available. Run trial first.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combining Trial$run and summary is faster than using</span></span></span>
<span class="r-in"><span><span class="co"># Trial$estimate_power when modifying only the parameters of the</span></span></span>
<span class="r-in"><span><span class="co"># decision-making function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  \<span class="op">(</span><span class="va">ni</span><span class="op">)</span> <span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>ni.margin <span class="op">=</span> <span class="va">ni</span><span class="op">)</span><span class="op">[</span>, <span class="st">"power"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in trial_summary(self = self, level = level, null = null, ni.margin = ni.margin,     alternative = alternative, reject.function = reject.function,     true.value = true.value, nominal.coverage = nominal.coverage,     estimates = estimates, ...):</span> No estimates available. Run trial first.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># changing the ate parameter value</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">50</span>, ate <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in names(estimators) &lt;- paste0("est", seq_along(estimators)):</span> 'names' attribute [1] must be the same length as the vector [0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># supplying another estimator</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">50</span>, estimators <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span>robust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$estimate_power`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># don't run because of high computational time</span></span></span>
<span class="r-in"><span><span class="co"># toy examples with small number of Monte-Carlo replicates</span></span></span>
<span class="r-in"><span><span class="co"># future::plan("multicore")</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>glm <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using previously defined estimators and summary.args</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimate_power</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in names(estimators) &lt;- paste0("est", seq_along(estimators)):</span> 'names' attribute [1] must be the same length as the vector [0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># supplying parameters to outcome function</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimate_power</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">20</span>, ate <span class="op">=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in names(estimators) &lt;- paste0("est", seq_along(estimators)):</span> 'names' attribute [1] must be the same length as the vector [0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># modifying arguments of summary function</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimate_power</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">20</span>, ate <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span> summary.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"&gt;"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in names(estimators) &lt;- paste0("est", seq_along(estimators)):</span> 'names' attribute [1] must be the same length as the vector [0]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># supplying estimators to overrule previously set estimators</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimate_power</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span> estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="est_adj.html">est_adj</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>partial argument match of 'X.cat' to 'X.cate'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 est2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05 0.05 </span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$estimate_samplesize`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># don't run because of high computational time</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> \<span class="op">(</span><span class="va">data</span>, <span class="va">ate</span>, <span class="va">sd</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">a</span> <span class="op">*</span> <span class="va">ate</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marginal <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>ate <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># supply model parameter and estimator to call to overwrite previously</span></span></span>
<span class="r-in"><span><span class="co"># set values</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">estimate_samplesize</span><span class="op">(</span>ate <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, estimator <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:03:42] Finding initial sample-size with bisection algorithm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:03:42] Evaluating left point: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:03:44] Evaluating right point: 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:03:48] Running stochastic approximation algorithm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:04:33] Refining estimate and calculating power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:04:45] [1/4] - power(10) = 0.941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:04:56] [2/4] - power(11) = 0.935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:05:08] [3/4] - power(16) = 0.994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:05:19] [4/4] - power(21) = 0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-11-05 15:05:19] Estimated sample size: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Estimated sample-size to reach 90% power ── </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n = 10 (actual estimated power≈93.94%)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reduce number of iterations for bisection step but keep R = 100</span></span></span>
<span class="r-in"><span><span class="co"># (default value)</span></span></span>
<span class="r-in"><span><span class="co"># trial$estimate_samplesize(bisection.control = list(niter = 2))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reduce significance level from 0.05 to 0.025, but keep alternative as</span></span></span>
<span class="r-in"><span><span class="co"># before</span></span></span>
<span class="r-in"><span><span class="co"># trial$estimate_samplesize(summary.args = list(level = 0.025))</span></span></span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$summary`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">outcome</span>, estimators <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># two-sided test with 0.05 significance level (alpha = 0.05) (default</span></span></span>
<span class="r-in"><span><span class="co"># values)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.05</span>, alternative <span class="op">=</span> <span class="st">"!="</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate    std.err    std.dev power na</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 -0.2586042 0.09297792 0.08489204  0.83  0</span>
<span class="r-in"><span><span class="co"># on-sided test</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span>, alternative <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate    std.err    std.dev power na</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 -0.2586042 0.09297792 0.08489204  0.83  0</span>
<span class="r-in"><span><span class="co"># non-inferiority test</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span>, ni.margin <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate    std.err    std.dev power na</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 -0.2586042 0.09297792 0.08489204   0.7  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># provide simulation results to summary method via estimates argument</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, R <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate    std.err   std.dev power na</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 0.01201245 0.09932767 0.1047944  0.07  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate empirical bias, rmse and coverage for true target parameter</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">res</span>, true.value <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate    std.err   std.dev power na       bias      rmse coverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> est1 0.01201245 0.09932767 0.1047944  0.07  0 0.01201245 0.1049588     0.85</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$print`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">a</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marginal <span class="op">=</span> <span class="fu"><a href="est_glm.html">est_glm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  info <span class="op">=</span> <span class="st">"Some trial info"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_model</span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">args_summary</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trial</span><span class="op">)</span> <span class="co"># only function headers</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Trial Object ── </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Some trial info </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model arguments:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • sd:  num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary arguments:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • level:  num 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • null:  num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • ni.margin:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • alternative:  chr "!="</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • reject.function:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • true.value:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • nominal.coverage:  num 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  function (n, ...)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  function (data, sd = 1, ...)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exclusion:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  function (x, ...)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimators:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1. marginal </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trial</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># also print function bodies</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Trial Object ── </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Some trial info </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model arguments:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • sd:  num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary arguments:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • level:  num 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • null:  num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • ni.margin:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • alternative:  chr "!="</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • reject.function:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • true.value:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  • nominal.coverage:  num 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   function (n, ...)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data.frame(a = rbinom(n, 1, 0.5)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   function (data, sd = 1, ...)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rnorm(nrow(data), data$a * -1, sd) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exclusion:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   function (x, ...)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     x </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimators:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1. marginal </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benedikt Sommer, Klaus K. Holst, Foroogh Shamsi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

