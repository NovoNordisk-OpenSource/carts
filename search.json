[{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to carts","title":"Contributing to carts","text":"First , thanks taking time contribute! ❤️ types contributions encouraged valued. See Table Contents details contribute code project. Please make sure read relevant section making contribution. make lot easier us maintainers smooth experience involved.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"table-of-contents","dir":"","previous_headings":"","what":"Table of Contents","title":"Contributing to carts","text":"Branches branch prefixes Style guide Unit testing Continuous Integration","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"branches-and-branch-prefixes","dir":"","previous_headings":"","what":"Branches and branch prefixes","title":"Contributing to carts","text":"package developed dev latest stable release made available main. Releases follow frequency 4 weeks, except hotfixes larger features become available. feature branches created dev. Branches containing hotfixes contrary created main avoid merging unfinished features dev main.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"branch-prefixes","dir":"","previous_headings":"Branches and branch prefixes","what":"Branch prefixes","title":"Contributing to carts","text":"use prefixes label branches. meaningful short description follows prefix hyphens (-) used separation. example, feature/new-trial-interface valid feature branch name. feature/: Branches developing new features.bugfix/: Branches fixing non-critical bugs.hotfix/: Branches fixing critical bugs.docs/: Branches writing, updating, fixing documentation.develop/: Branches anything else.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"pull-requests","dir":"","previous_headings":"Branches and branch prefixes","what":"Pull requests","title":"Contributing to carts","text":"Except hotfixes, pull requests (PRs) must made dev. title PR follow format conventional commits summary proposed changes must provided body PR. makes easier maintainers title body can reused commits squashed merging feature branch dev.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"style-guide","dir":"","previous_headings":"","what":"Style guide","title":"Contributing to carts","text":"Contributors set development environment comply project specified editorconfig configuration lintr static code analysis tool. follow largest extent tidyverse style guide, checked via code linter. notable difference use dots long argument names functions. example, instead outcome_name use outcome.name. remain using snake case names functions R6 class methods. declare argument types parameters roxygen documentation following {r} #' @param n (integer) Number observations (sample size) #' @param estimators (list function) List estimators single unnamed estimator convention.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"unit-testing","dir":"","previous_headings":"","what":"Unit testing","title":"Contributing to carts","text":"Unit tests written using tinytest framework go inst/tinytest directory. Tests take considerable time complete (seconds) go inst/slowtest. tests performed checking package R CMD check. organization test files match organization R files. , tests function R/Trial.R go tinytest/test_Trial.R. Tinytest make internal functions directly callable like unit testing packages . Thus, testing internal functions requires using ::: inside test files like {r} output <- carts:::some_internal_function(1) expect_equal(output, 2) information unit testing tinytest provided vignette.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"continuous-integration","dir":"","previous_headings":"","what":"Continuous integration","title":"Contributing to carts","text":"variety continuous integration tests set .github/workflows mitigate risk committing malfunctioning code main. Linting checks (lint-project.yaml), checking synchronicity Rd files roxygen code (check-roxygen.yaml), unit tests rcmdcheck (r-cmd-check.yaml) workflows triggered every PR dev main. CI builds triggered new commit feature branch, reduce waiting times compute costs, slow unit tests (slow-tests.yaml) building vignettes (vignettes.yaml) triggered PRs marked ready review. , running tests workflows prevented submitting pull requests drafts.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/CONTRIBUTING.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributing to carts","text":"guide based contributing.md. Make !","code":""},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"carts: getting started","text":"carts package clinical trial simulation tool power sample size estimation. modular, building-block design allows simulation many common clinical trial designs lines code. addition, package provides range estimators continuous, count survival endpoints. vignette introduces basic functionalities carts package aims familarize reader package interface. centerpiece interface R6 reference class Trial, constructor main methods visualized Figure 1. end, consider two-armed parallel trial design introduce Trial class demonstrate power sample size estimation carried conveniently. ‘Trial’ R6 reference class. blue boxes define arguments constructor, red boxes important class methods.","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"setting-up-parallel-computations","dir":"Articles","previous_headings":"Preliminaries","what":"Setting up parallel computations","title":"carts: getting started","text":"carts package basing power sample size estimation Monte Carlo integration techniques. deal computationally intensive procedures, package uses extensive parallel computations based future package. enable , needs done define desired parallel backend, .e. enables parallelization available cores current machine. equally straight-forward set parallel batch computations cluster (see example future.batchtools).","code":"future::plan(future::multicore)"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"progress-bars-and-logging-information","dir":"Articles","previous_headings":"Preliminaries","what":"Progress bars and logging information","title":"carts: getting started","text":"calculations can time-consuming recommend enabling progress-bars, can achieved following code. refer progressr vignette information customize progress bar appeareance. output carts package handled logger logging utility. refer following article information alter logging level change destination log records, can useful running carts package batch jobs cluster.","code":"progressr::handlers(global = TRUE) progressr::handlers(progressr::handler_progress(times = 100))"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"reproducibility","dir":"Articles","previous_headings":"Preliminaries","what":"Reproducibility","title":"carts: getting started","text":"sufficient use top-level seed reproducibility simulations future package used parallelization local machine. Additional care must taken distributed computations compute cluster.","code":"library(\"carts\") set.seed(42)"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"two-armed-parallel-design","dir":"Articles","previous_headings":"","what":"Two-armed parallel design","title":"carts: getting started","text":"consider two-armed parallel design outcome interest Y∣W,∼N(β0+βwW+βaA,σ2)\\begin{align*} Y \\mid W, \\sim N(\\beta_0 + \\beta_w W + \\beta_a , \\sigma^2) \\end{align*} treatment variable ∼Bernoulli(0.5)\\sim Bernoulli(0.5) independent baseline covariate W∼N(0,1)W \\sim N(0, 1).","code":""},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"trial-model","dir":"Articles","previous_headings":"Two-armed parallel design","what":"Trial model","title":"carts: getting started","text":"simulate trial first define random number generators treatment indicator AA baseline covariate WW context carts covariate model. general rule simulating trial designs time-invariant outcomes, .e. outcomes function information available baseline/randomization, covariate model function first argument n (sample size) returns covariate data tabulated form, either data.frame data.table. Additional parameters covariate model can added sample size argument n, treatment probability p.. trial model design completed help outcome_continuous. built-function generates continuous outcomes tabulated baseline covariates, .e. output covariate model. default arguments built-functions can updated conveniently setargs desired parameters trial. Simulating trial Y∣W,∼N(10−0.5A−1.2W,1.5)\\begin{align*} Y \\mid W, \\sim N(10 - 0.5 - 1.2 W , 1.5) \\end{align*} requires update default arguments outcome_continuous Finally, instantiate model object R6 Trial class , default, exclusion model used.","code":"covariate <- function(n, p.a = 0.5) {   return(     data.frame(     a = rbinom(n, 1, p.a),     w = rnorm(n)   )   ) } outcome <- setargs(   outcome_continuous,   mean = ~ 1 + a + w,   par = c(10, -0.5, -1.2), # coef order as defined by the above formula   sd = 1.5 ** 0.5 ) trial <- Trial$new(   covariates = covariate,   outcome = outcome,   exclusion = identity, # no exclusion criteria (default)   info = \"Two-armed parallel design\" # optional info )"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"trial-simulation","dir":"Articles","previous_headings":"Two-armed parallel design","what":"Trial simulation","title":"carts: getting started","text":"Simulating data defined model object done via simulate method method wrapper calling carts:::trial_simulate combines sampling data covariate outcome model, application exclusion model iterative process. First n subjects sampled covariate model. sampled tabulated data converted data.table passed outcome model. sampled covariate outcome data passed together single data.table exclusion model. Thus, exclusion model allows removing subjects based covariate outcome data. subjects removed, remaining subjects stored next iteration begins sampling covariate model. process repeats total n subjects sampled. Without additional arguments, method uses assigned default arguments covariate outcome model generate sample. Inspecting simulated data reveals package adds subject (id) period (num) identifiers output method. default behaviour provides functionality follow subjects across multiple periods within-subject trial designs.","code":"dd <- trial$simulate(n = 1e4) table(dd$a) ##  ##    0    1  ## 5001 4999 head(dd, 2) ##       id     a          w   num        y ##    <num> <int>      <num> <num>    <num> ## 1:     1     1 0.07122244     0 8.165036 ## 2:     2     1 0.97029003     0 7.411990"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"updating-model-parameters","dir":"Articles","previous_headings":"Two-armed parallel design > Trial simulation","what":"Updating model parameters","title":"carts: getting started","text":"Additional arguments accepted simulate method allow simulating trial object varying model parameters. circumvents instantiation new model object provides elegant way carry parameter sensitivity analyses interactively use trial model fact, public methods Trial class allow passing arguments underlying covariate, outcome exclusion models via optional argument Trial method.","code":"trial$simulate(n = 1e4, p.a = 0.9)$a |> table() ##  ##    0    1  ## 1017 8983"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"safeguarding-parameter-clashes","dir":"Articles","previous_headings":"Two-armed parallel design > Trial simulation > Updating model parameters","what":"Safeguarding parameter clashes","title":"carts: getting started","text":"simulate method passes defined model parameters internally covariate, outcome exclusion models. given example means model component function calls receive p.= 0.9 optional argument. enables updating shared parameters model components single value also opens pathway accidentally overwriting default parameters built-functions. simple solution preventing achieved using functional wrappers. shown covariate model, default value p.changed dynamically anymore.","code":"trial0 <- Trial$new(   covariates = covariate,   outcome = function(data, p.a = 0.1) rbinom(nrow(data), 1, p.a) ) trial0$simulate(1e4)[, list(y = mean(y), a = mean(a))] ##         y      a ##     <num>  <num> ## 1: 0.1009 0.4876 trial0$simulate(1e4, p.a = 1)[, list(y = mean(y), a = mean(a))] ##        y     a ##    <num> <num> ## 1:     1     1 trial0 <- Trial$new(   covariates = function(n) covariate(n),   outcome = function(data, p.a = 0.1) rbinom(nrow(data), 1, p.a) ) trial0$simulate(1e4, p.a = 1)[, list(y = mean(y), a = mean(a))] ##        y      a ##    <num>  <num> ## 1:     1 0.4926"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"updating-default-parameters-of-a-trial-model","dir":"Articles","previous_headings":"Two-armed parallel design > Trial simulation > Updating model parameters","what":"Updating default parameters of a trial model","title":"carts: getting started","text":"Trial class also allows set update default arguments covariate, outcome exclusion models. Another way utilise built-functions therefore initialize trial object set default values outcome model Using args_model method updates model.args attribute trial object, used internally default option simulate trial data. However, parameters trial$model.args overruled parameters matching names passed simulate method.","code":"trial <- Trial$new(   covariates = covariate,   outcome = outcome_continuous ) trial$args_model(   mean = ~ 1 + a + w,   par = c(10, -0.5, -1.2) ) trial$simulate(1e4)[, list(y = mean(y)), by = \"a\"] ##        a         y ##    <int>     <num> ## 1:     0 10.037275 ## 2:     1  9.515117 trial$simulate(1e4, par = c(0, 20, 0))[, list(y = mean(y)), by = \"a\"] ##        a           y ##    <int>       <num> ## 1:     1 19.99394634 ## 2:     0 -0.01365177"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"estimators","dir":"Articles","previous_headings":"Two-armed parallel design","what":"Estimators","title":"carts: getting started","text":"carts package provides range estimators various trial designs. built-estimators function generators return estimator, function data (first input argument). compatible package design, estimator must return named vector includes estimate (Estimate) standard errors (“Std.Err”). returned vector may include additional elements interfere internal procedures. crude (marginal) estimator can defined using est_glm, function generator Estimators can assigned trial object either initialization via estimators argument Trial$new initialization assigned estimators can retrieved calling estimator method printing trial object","code":"estimator <- est_glm(   response = \"y\", # default value   treatment = \"a\" # default value ) data <- trial$simulate(n = 300) estimator(data) ##   Estimate Std.Err    2.5%   97.5%  P-value ## a  -0.5394  0.1918 -0.9153 -0.1635 0.004914 trial$estimators(marginal = est_glm()) # using def. args. of est_glm names(trial$estimators()) ## [1] \"marginal\" print(trial) ## ── Trial Object ──  ##  ## Model arguments:   ##  • mean: Class 'formula'  language ~1 + a + w ##  • par:  num [1:3] 10 -0.5 -1.2 ##  ## Summary arguments:   ##  ## Covariates: ##  function (n, p.a = 0.5, ...)    ##  ## Outcome: ##  function (data, mean = NULL, par = NULL, sd = 1, het = 0, outcome.name = \"y\",      remove = c(\"id\", \"num\"), family = gaussian(), ...)    ##  ## Exclusion: ##  function (x, ...)    ##  ## Estimators: ##   1. marginal  ## ────────────────────"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"power-estimation","dir":"Articles","previous_headings":"Two-armed parallel design","what":"Power estimation","title":"carts: getting started","text":"Carrying power estimations straightforward estimators assigned trial model.","code":"trial$estimate_power(   n = 300, # sample size   R = 500 # number of Monte Carlo replicates ) ## [1] 0.778"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"hypothesis-testing","dir":"Articles","previous_headings":"Two-armed parallel design > Power estimation","what":"Hypothesis testing","title":"carts: getting started","text":"method uses carts:::summary.runtrials internally implement hypothesis test given trial design. default, two-sided test carried null hypothesis treatment effect 0.05 signifcance level. test can changed via summary.args argument","code":"trial$estimate_power(n = 300, R = 500,   summary.args = list(alternative = \">\") # one-sided test should   # have no power as a < 0 ) ## [1] 0"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"updating-model-parameters-1","dir":"Articles","previous_headings":"Two-armed parallel design > Power estimation","what":"Updating model parameters","title":"carts: getting started","text":"Arguments covariate, outcome exclusion models can passed via optional arguments method. behavior identical one Trial$simulate. , passed arguments overwrite default values Trial$model.args. One note current interface pass optional arguments estimators. consequence, estimators must initialized values assigned optional arguments.","code":"trial$estimate_power(n = 300, R = 500, p.a = 0.1) ## [1] 0.376"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"multiple-estimators","dir":"Articles","previous_headings":"Two-armed parallel design > Power estimation","what":"Multiple estimators","title":"carts: getting started","text":"default settings carts estimate power estimators defined Trial$estimators.","code":"trial$estimators(adjusted = est_glm(covariates = \"w\")) trial$estimate_power(n = 300, R = 500) ## marginal adjusted  ##    0.792    0.992"},{"path":"https://novonordisk-opensource.github.io/carts/articles/gettingstarted.html","id":"sample-size-estimations","dir":"Articles","previous_headings":"Two-armed parallel design","what":"Sample-size estimations","title":"carts: getting started","text":"Last, estimate sample size required attain 90% power specified trial model estimator method optimizes sample size internally calling Trial$estimate_power method. Therefore, behavior updating model parameters changing default settings hypothesis test identical. , model parameters passed optional arguments set via args_model method, summary.args argument used change hypothesis test.","code":"trial$estimate_samplesize(   power = 0.9, # default   estimator = trial$estimators(\"adjusted\") ) ## INFO [2025-11-03 09:52:27] Finding initial sample-size with bisection algorithm ## INFO [2025-11-03 09:52:27] Evaluating left point: 50 ## INFO [2025-11-03 09:52:29] Evaluating right point: 10000 ## INFO [2025-11-03 09:52:36] Evaluating mid point: 5025  [iteration 1/6] ## INFO [2025-11-03 09:52:42] Evaluating mid point: 2537.5  [iteration 2/6] ## INFO [2025-11-03 09:52:44] Evaluating mid point: 1293.75  [iteration 3/6] ## INFO [2025-11-03 09:52:45] Evaluating mid point: 671.875  [iteration 4/6] ## INFO [2025-11-03 09:52:46] Evaluating mid point: 360.9375  [iteration 5/6] ## INFO [2025-11-03 09:52:47] Evaluating mid point: 205.46875  [iteration 6/6] ## INFO [2025-11-03 09:52:49] Running stochastic approximation algorithm ## INFO [2025-11-03 09:53:58] Refining estimate and calculating power ## INFO [2025-11-03 09:54:07] [1/5] - power(155) = 0.882 ## INFO [2025-11-03 09:54:16] [2/5] - power(160) = 0.878 ## INFO [2025-11-03 09:54:25] [3/5] - power(165) = 0.885 ## INFO [2025-11-03 09:54:34] [4/5] - power(170) = 0.906 ## INFO [2025-11-03 09:54:44] [5/5] - power(175) = 0.914 ## INFO [2025-11-03 09:54:44] Estimated sample size: 169 ## ── Estimated sample-size to reach 90% power ──  ##  ## n = 169 (actual estimated power≈89.99%)"},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Benedikt Sommer. Author, maintainer. Klaus K. Holst. Author. Foroogh Shamsi. Author.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sommer B, Holst K, Shamsi F (2025). carts: Simulation-Based Assessment Covariate Adjustment Randomized Trials. R package version 0.1.0.","code":"@Manual{,   title = {carts: Simulation-Based Assessment of Covariate Adjustment in Randomized Trials},   author = {Benedikt Sommer and Klaus K. Holst and Foroogh Shamsi},   year = {2025},   note = {R package version 0.1.0}, }"},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"carts-package","dir":"","previous_headings":"","what":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"carts R package simulation tool exploring various estimators within clinical trial context differing assumptions. package provides user-friendly interface defining clinical trial object different choices design, patient endpoint distributions, treatment effect estimators. clinical trial object specified, package provides functionality estimating power Monte Carlo simulations.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"emulate simple parallel trial design observed unobserved covariates. treatment effect estimated using estimator based efficient influence function (EIF) adjust observed covariate x. necessary sample-size achieve 90% power one-sided superiority test estimated using variation bisection Robbins-Monro stochastic approximation algorithm parallelized computations","code":"library(\"carts\")  ## Loading required package: lava  library(\"data.table\") future::plan(future::multicore) ## progressr::handlers(global = TRUE) ## progressr::handlers(progressr::handler_cli)  ## Covariates at baseline x0 <- function(n, pa = 0.5, gamma.var = 0.7, ...) {   data.table(     a = rbinom(n, 1, pa), ## Treatment     x = rnorm(n), ## Obs.     z = log(rgamma(n, shape = 1 / gamma.var, rate = 1 / gamma.var)) ## Unobs.   ) } ## Outcome model outcome <- function(data, b = c(log(2.5), log(0.38)), ...) {   X <- model.matrix(~ 1 + a, data)   rate <- exp(X %*% b + with(data, x + z))   data.table(y = rpois(length(rate), rate)) }  qmodel  <- targeted::learner_glm(y ~ a * x, family = poisson) m <- Trial$new(   covariates = x0,   outcome = outcome,   estimators = list(adj = est_adj(qmodel))   )  ## Sample-size estimation via Stochastic Approximation e <- m$estimate_samplesize(R = 1000) print(e)  ## ── Estimated sample-size to reach 90% power ──  ##  ## n = 98 (actual estimated power≈91.18%)"},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"package can installed unix systems command line via make install. Already installed R packages dependencies carts upgrade make install. Instead, use make upgrade rule upgrade dependencies, followed installation package.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"project-organization","dir":"","previous_headings":"","what":"Project organization","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"use dev branch development main branch stable releases. releases follow semantic versioning, tagged notable changes reported NEWS.md file.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"i-have-a-question--i-want-to-report-a-bug","dir":"","previous_headings":"","what":"I Have a Question / I Want to Report a Bug","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"want ask questions, require help clarification, report bug, recommend either contact maintainer directly following: Open Issue. Provide much context can ’re running . Provide project platform versions, depending seems relevant. take care issue soon possible.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/index.html","id":"maintainers","dir":"","previous_headings":"","what":"Maintainers","title":"Simulation-Based Assessment of Covariate Adjustment in Randomized Trials","text":"Benedikt Sommer (benediktsommer92@gmail.com) Klaus Kähler Holst (klaus@holst.)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":null,"dir":"Reference","previous_headings":"","what":"R6 class for power and sample-size calculations for a clinical trial — Trial","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Simulation RCT flexible covariates distributions simulation.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Klaus Kähler Holst, Benedikt Sommer Benedikt Sommer Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"info Optional information/name model covariates covariate generator (function sample-size n optional parameters) outcome_model Generator outcome given covariates (function covariates x long format) exclusion function defining exclusion criterion estimates (trial.estimates) Parameter estimates Monte-Carlo simulations returned Trial$run(). field flushed, .e. set default value NULL, model arguments (Trial$args_model()) estimators (Trial$estimators()) modified. summary.args list arguments override default values Trial$summary() power sample sizes estimated Trial$estimate_power() Trial$estimate_samplesize()","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Trial$new() Trial$args_model() Trial$args_summary() Trial$estimators() Trial$simulate() Trial$run() Trial$estimate_power() Trial$estimate_samplesize() Trial$summary() Trial$print() Trial$clone()","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Initialize new Trial object","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$new(   outcome,   covariates = NULL,   exclusion = identity,   estimators = list(),   summary.args = list(),   info = NULL )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"outcome outcome model given covariates (first positional argument must covariate data) covariates covariate simulation function (must 'n' first named argument returns either list data.table (data.frame) observation period single data.table (data.frame) case single observation period) exclusion function describing selection criterion (first positional argument must combined covariate outcome data function must return subjects included trial) estimators optional list estimators single estimator function summary.args list arguments override default values Trial$summary() power sample sizes estimated Trial$estimate_power() Trial$estimate_samplesize() info optional string describing model","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-args-model-","dir":"Reference","previous_headings":"","what":"Method args_model()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Get, specify update parameters covariate, outcome exclusion model. Parameters set named list, updated parameter names match existing values list.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$args_model(.args = NULL, .reset = FALSE, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":".args (list character) named list arguments update set. single subset arguments can retrieved passing respective argument names character character vector. .reset (logical character) Reset subset previously set parameters. Can combined setting new parameters. ... Alternative using .args update set arguments","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"trial <- Trial$new(   covariates = function(n, p = 0.5) data.frame(a = rbinom(n, 1, p)),   outcome = function(data, ate, mu) rnorm(nrow(data), mu + data$a * ate) )  # set and update parameters trial$args_model(.args = list(ate = 2, p = 0.5, mu = 3)) trial$args_model(ate = 5, p = 0.6) # update parameters trial$args_model(list(ate = 2), p = 0.5) # combine first arg with ...  # retrieve parameters trial$args_model() # return all set parameters trial$args_model(\"ate\") # select a single parameter trial$args_model(c(\"ate\", \"mu\")) # multiple parameters  # remove parameters trial$args_model(.reset = \"ate\") # remove a single parameter trial$args_model(.reset = TRUE) # remove all parameters  # remove and set/update parameters trial$args_model(ate = 2, p = 0.5, .reset = TRUE) trial$args_model(ate = 5, .reset = \"p\") # removing p and updating ate"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-args-summary-","dir":"Reference","previous_headings":"","what":"Method args_summary()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Get, specify update summary.args attribute.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$args_summary(summary.args = NULL, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"summary.args list arguments update set ... arguments update set","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-1","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"trial <- Trial$new(   covariate = function(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = function(data, ate, mu) rnorm(nrow(data), mu + data$a * ate) ) # set summary.args via optional arguments trial$args_summary(level = 0.025) # return summary_args trial$args_summary() # update summary_args parameter via summary.args argument trial$args_summary(summary.args = list(level = 0.05)) trial$args_summary()"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-estimators-","dir":"Reference","previous_headings":"","what":"Method estimators()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Get, specify update estimators.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$estimators(.estimators = NULL, .reset = FALSE, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":".estimators (list, function character) Argument controlling getter setter behavior. Estimators set updated providing single estimator (function) list estimators, retrieved providing character (see examples). .reset (logical character) Reset subset previously set estimators. Can combined setting new estimators. ... Alternative .estimators updating setting estimators.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"name internally assigned estimators calling method .estimators set single estimator list unnamed elements. names combination est prefix integer indicates nth added unnamed estimator.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-2","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"estimators <- list(marginal = est_glm(), adj = est_glm(covariates = \"x\")) trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), x = rnorm(n)),   outcome = \\(data, ate = -0.5) rnorm(nrow(data), data$a * ate),   estimators = estimators )  # get estimators trial$estimators() |> names() # list all estimators trial$estimators(\"marginal\") |> names() # select a single estimator trial$estimators(c(\"marginal\", \"adj\")) |> names() # select mult. est.  # remove estimators trial$estimators(.reset = \"marginal\") # remove a single estimator trial$estimators(.reset = TRUE) # remove all estimators  # set or update estimators trial$estimators(estimators) trial$estimators(adj2 = est_adj(covariates = \"x\")) # add new estimator # update adj and remove adj2 trial$estimators(adj = est_glm(covariates = \"x\"), .reset = \"adj2\")  # unnamed estimators (adding default name) estimators <- list(est_glm(), est_glm(covariates = \"x\")) trial$estimators(estimators, .reset = TRUE) trial$estimators(.reset = \"est1\") trial$estimators(est_glm()) # replaces removed est1"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-simulate-","dir":"Reference","previous_headings":"","what":"Method simulate()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Simulate data applying parameters trial model. method samples first covariate model. Outcome data sampling follows passing simulated covariate data outcome model. optional exclusion model applied combined covariates outcomes data. sampling process repeated case subjects removed exclusion model total n subjects sampled maximum iteration number .niter reached. method adds two auxiliary columns simulated data identify distinct patients (id) periods (num) case time-dependent covariate outcome models. columns added sampled covariate data sampling outcomes. data.table columns provided outcome model case covariate model defined. Thus, outcome model always applied least data.table id num column. default column name y used outcome variable returned data.table defined outcome model returns vector. name easily changed returning data.table named column (see examples). optional argument ... method can used provide parameters trial model addition parameters already defined via Trial$args_model(). Data simulated union parameters, parameters provided via optional argument method take precedence parameters defined via Trial$args_model(). However, parameters set via Trial$args_model() updated optional arguments provided.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$simulate(n, .niter = 500L, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"n (integer) Number observations (sample size) .niter (integer) Maximum number simulation runs avoid infinite loops ill defined exclusion functions. ... Arguments covariate, outcome exclusion model functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"data.table n rows","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-3","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)) )  # applying and modifying parameters n <- 10 trial$simulate(n) # use parameters set during initialization trial$args_model(ate = -100) # update parameters trial$simulate(n) trial$simulate(n, ate = 100) # change ate via optional argument  # rename outcome variable trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) {     data.frame(yy = with(data, rnorm(nrow(data), a * ate)))   } ) trial$simulate(n)  # return multiple outcome variables trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), y.base = rnorm(n)),   outcome = \\(data, ate = 0) {     y  <-  with(data, rnorm(nrow(data), a * ate))     return(data.frame(y = y, y.chg = data$y.base - y))   } ) trial$simulate(n)  # use exclusion argument to post-process sampled outcome variable to # achieve the same as in the above example but without modifying the # originally defined outcome model trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), y.base = rnorm(n)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   exclusion = \\(data) {    cbind(data, data.frame(y.chg = data$y.base - data$y))   } ) trial$simulate(n)  # no covariate model trial <- Trial$new(   outcome = \\(data, ate = 0) {     n <- nrow(data)     a <- rbinom(n, 1, 0.5)     return(data.frame(a = a, y = rnorm(n, a * ate)))   } ) trial$simulate(n)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-run-","dir":"Reference","previous_headings":"","what":"Method run()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Run trial estimate parameters multiple times method calls Trial$simulate() R times applies specified estimators simulated dataset sample size n. Parameters covariates, outcome exclusion models can provided optional arguments method call addition parameters already defined via Trial$args_model(). behavior identical Trial$simulate(), except .niter can provided optional argument method controlling maximum number simulation runs Trial$simulate(). Estimators fail silently errors occurring applying estimator simulated dataset terminate method call. returned trial.estimates object instead indicate estimators failed.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$run(n, R = 100, estimators = NULL, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"n (integer) Number observations (sample size) R (integer) Number replications estimators (list function) List estimators single unnamed estimator ... Arguments covariate, outcome exclusion model functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"(invisible) object class trial.estimates, contains estimates estimators information repeat simulation. return object also assigned estimates field Trial class object (see examples).","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-4","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"# future::plan(\"multicore\") trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   estimators = list(glm = est_glm()) ) trial$args_summary(alternative = \"<\")  # the returned trial.estimates object contains the estimates for each of # the R simulated data sets + all necessary information to re-run the # simulation res <- trial$run(n = 100, R = 50) # store return object in a new variable print(trial$estimates) # trial$estimates == res  # the basic usage is to apply the summary method to the generated # trial.estimates object. trial$summary()  # combining Trial$run and summary is faster than using # Trial$estimate_power when modifying only the parameters of the # decision-making function sapply(   c(0, 0.25, 0.5),   \\(ni) trial$summary(ni.margin = ni)[, \"power\"] )  # changing the ate parameter value trial$run(n = 100, R = 50, ate = -0.2)  # supplying another estimator trial$run(n = 100, R = 50, estimators = est_glm(robust = FALSE))"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-estimate-power-","dir":"Reference","previous_headings":"","what":"Method estimate_power()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Estimates statistical power specified trial Convenience method first runs Trial$run() subsequently applies Trial$summary() derive power estimator. behavior passing arguments lower level functions identical Trial$run().","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$estimate_power(n, R = 100, estimators = NULL, summary.args = list(), ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"n (integer) Number observations (sample size) R (integer) Number replications estimators (list function) List estimators single unnamed estimator summary.args (list) Arguments passed summary method decision-making ... Arguments covariate, outcome exclusion model functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"numeric","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-5","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"# toy examples with small number of Monte-Carlo replicates # future::plan(\"multicore\") trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   estimators = list(glm = est_glm()) ) trial$args_summary(alternative = \"<\")  # using previously defined estimators and summary.args trial$estimate_power(n = 100, R = 20)  # supplying parameters to outcome function trial$estimate_power(n = 100, R = 20, ate = -100)  # modifying arguments of summary function trial$estimate_power(n = 100, R = 20, ate = -100,  summary.args = list(alternative = \">\") )  # supplying estimators to overrule previously set estimators trial$estimate_power(n = 100, R = 20,  estimators = list(est_glm(), est_adj()))"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-estimate-samplesize-","dir":"Reference","previous_headings":"","what":"Method estimate_samplesize()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Estimate minimum sample-size required reach desired statistical power specified estimator. initial rough estimate obtained via bisection, followed stochastic approximation (Robbins-Monro) algorithm, finally, grid search (refinement step) neighbourhood current best solution. Note estimation procedure sample size populate estimates attribute trial object.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$estimate_samplesize(   ...,   power = 0.9,   estimator = NULL,   interval = c(50L, 10000L),   bisection.control = list(R = 100, niter = 6),   sa.control = list(R = 1, niter = 250, stepmult = 100, alpha = 0.5),   refinement = seq(-10, 10, by = 5),   R = 1000,   interpolate = TRUE,   verbose = TRUE,   minimum = 10L,   summary.args = list() )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"... Arguments covariate, outcome exclusion model functions power (numeric) Desired statistical power estimator (list function) Estimator (function) applied. NULL, estimate sample size estimators defined via Trial$estimators(). prefix est used label unnamed estimators. interval (integer vector) Interval initially look solution bisection algorithm. Passing integer skip bisection algorithm use provided integer initial solution stochastic approximation algorithm bisection.control (list) Options controlling bisection algorithm (bisection). Default values can also changed subset options (see examples). sa.control (list) Options controlling stochastic approximation (Robbins-Monro) algorithm (optim_sa). Default values can also changed subset options (see examples). refinement (integer vector) Vector create interval whose center sample size estimate Robbins-Monro algorithm. R (integer) Number replications use Monte Carlo simulation refinement calculations. interpolate (logical) TRUE, linear interpolation refinement points used estimate power. verbose (logical) TRUE, additional output displayed. minimum (integer) Minimum sample size. summary.args (list) Arguments passed summary method decision-making","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"samplesize_estimate S3 object","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-6","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"\\dontrun{ trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate, sd) with(data, rnorm(nrow(data), a * ate, sd)),   estimators = list(marginal = est_glm()) ) trial$args_model(ate = -1, sd = 5) trial$args_summary(alternative = \"<\")  # supply model parameter and estimator to call to overwrite previously # set values trial$estimate_samplesize(ate = -2, estimator = est_glm())  # reduce number of iterations for bisection step but keep R = 100 # (default value) trial$estimate_samplesize(bisection.control = list(niter = 2))  # reduce significance level from 0.05 to 0.025, but keep alternative as # before trial$estimate_samplesize(summary.args = list(level = 0.025)) }"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-summary-","dir":"Reference","previous_headings":"","what":"Method summary()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Summarize Monte Carlo studies different estimators treatment effect randomized clinical trial. method reports power superiority tests (one-sided two-sided) non-inferiority tests, together summary statistics different estimators.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$summary(   level = 0.05,   null = 0,   ni.margin = NULL,   alternative = c(\"!=\", \"<\", \">\"),   reject.function = NULL,   true.value = NULL,   nominal.coverage = 0.9,   estimates = NULL,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"level significance level null null hypothesis test ni.margin non-inferiority margin alternative alternative hypothesis (equal !=, less <, greater >) reject.function Optional function calculating whether reject null hypothesis true.value Optional true parameter value nominal.coverage Width confidence limits estimates Optional trial.estimates object. provided, estimates used instead object's stored estimates. allows calculating summaries different trial results without modifying object's state. ... additional arguments lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"matrix results estimator stored separate rows","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"Print method Trial objects","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$print(..., verbose = FALSE)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"... Additional arguments lower level functions verbose (logical) default, print function arguments covariates, outcome exclusion models. TRUE, also print function body.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"examples-7","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"trial <- Trial$new(   covariates = function(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = function(data, sd = 1) rnorm(nrow(data), data$a * -1, sd),   estimators = list(marginal = est_glm()),   info = \"Some trial info\" ) trial$args_model(sd = 2) trial$args_summary(level = 0.025)  print(trial) # only function headers print(trial, verbose = TRUE) # also print function bodies"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"objects class cloneable method.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"Trial$clone(deep = FALSE)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"deep Whether make deep clone.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/Trial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"R6 class for power and sample-size calculations for a clinical trial — Trial","text":"","code":"if (FALSE) { # \\dontrun{ trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), x = rnorm(n)),   outcome = setargs(outcome_count, par = c(1, 0.5, 1), overdispersion = 0.7) )  trial$estimators(   unadjusted = est_glm(family = \"poisson\"),   adjusted = est_glm(family = \"poisson\", covariates = \"x\") )  trial$run(n = 200, R = 100) trial$summary() } # }  ## ------------------------------------------------ ## Method `Trial$args_model` ## ------------------------------------------------  trial <- Trial$new(   covariates = function(n, p = 0.5) data.frame(a = rbinom(n, 1, p)),   outcome = function(data, ate, mu) rnorm(nrow(data), mu + data$a * ate) )  # set and update parameters trial$args_model(.args = list(ate = 2, p = 0.5, mu = 3)) trial$args_model(ate = 5, p = 0.6) # update parameters trial$args_model(list(ate = 2), p = 0.5) # combine first arg with ...  # retrieve parameters trial$args_model() # return all set parameters #> $ate #> [1] 2 #>  #> $p #> [1] 0.5 #>  #> $mu #> [1] 3 #>  trial$args_model(\"ate\") # select a single parameter #> [1] 2 trial$args_model(c(\"ate\", \"mu\")) # multiple parameters #> $ate #> [1] 2 #>  #> $mu #> [1] 3 #>   # remove parameters trial$args_model(.reset = \"ate\") # remove a single parameter trial$args_model(.reset = TRUE) # remove all parameters  # remove and set/update parameters trial$args_model(ate = 2, p = 0.5, .reset = TRUE) trial$args_model(ate = 5, .reset = \"p\") # removing p and updating ate  ## ------------------------------------------------ ## Method `Trial$args_summary` ## ------------------------------------------------  trial <- Trial$new(   covariate = function(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = function(data, ate, mu) rnorm(nrow(data), mu + data$a * ate) ) #> Warning: partial argument match of 'covariate' to 'covariates' # set summary.args via optional arguments trial$args_summary(level = 0.025) # return summary_args trial$args_summary() #> $level #> [1] 0.025 #>  # update summary_args parameter via summary.args argument trial$args_summary(summary.args = list(level = 0.05)) trial$args_summary() #> $level #> [1] 0.05 #>   ## ------------------------------------------------ ## Method `Trial$estimators` ## ------------------------------------------------  estimators <- list(marginal = est_glm(), adj = est_glm(covariates = \"x\")) trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), x = rnorm(n)),   outcome = \\(data, ate = -0.5) rnorm(nrow(data), data$a * ate),   estimators = estimators )  # get estimators trial$estimators() |> names() # list all estimators #> [1] \"marginal\" \"adj\"      trial$estimators(\"marginal\") |> names() # select a single estimator #> NULL trial$estimators(c(\"marginal\", \"adj\")) |> names() # select mult. est. #> [1] \"marginal\" \"adj\"       # remove estimators trial$estimators(.reset = \"marginal\") # remove a single estimator trial$estimators(.reset = TRUE) # remove all estimators  # set or update estimators trial$estimators(estimators) trial$estimators(adj2 = est_adj(covariates = \"x\")) # add new estimator # update adj and remove adj2 trial$estimators(adj = est_glm(covariates = \"x\"), .reset = \"adj2\")  # unnamed estimators (adding default name) estimators <- list(est_glm(), est_glm(covariates = \"x\")) trial$estimators(estimators, .reset = TRUE) trial$estimators(.reset = \"est1\") trial$estimators(est_glm()) # replaces removed est1  ## ------------------------------------------------ ## Method `Trial$simulate` ## ------------------------------------------------  trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)) )  # applying and modifying parameters n <- 10 trial$simulate(n) # use parameters set during initialization #>        id     a   num          y #>     <num> <int> <num>      <num> #>  1:     1     1     0 -1.8218177 #>  2:     2     0     0 -0.2473253 #>  3:     3     0     0 -0.2441996 #>  4:     4     0     0 -0.2827054 #>  5:     5     0     0 -0.5536994 #>  6:     6     0     0  0.6289820 #>  7:     7     1     0  2.0650249 #>  8:     8     1     0 -1.6309894 #>  9:     9     1     0  0.5124269 #> 10:    10     0     0 -1.8630115 trial$args_model(ate = -100) # update parameters trial$simulate(n) #>        id     a   num             y #>     <num> <int> <num>         <num> #>  1:     1     0     0    0.36295126 #>  2:     2     1     0 -101.30454355 #>  3:     3     0     0    0.73777632 #>  4:     4     0     0    1.88850493 #>  5:     5     1     0 -100.09744510 #>  6:     6     1     0 -100.93584735 #>  7:     7     0     0   -0.01595031 #>  8:     8     0     0   -0.82678895 #>  9:     9     1     0 -101.51239965 #> 10:    10     0     0    0.93536319 trial$simulate(n, ate = 100) # change ate via optional argument #>        id     a   num           y #>     <num> <int> <num>       <num> #>  1:     1     1     0  98.0899125 #>  2:     2     0     0  -0.2792372 #>  3:     3     1     0  99.6865540 #>  4:     4     0     0   1.0673079 #>  5:     5     1     0 100.0700349 #>  6:     6     1     0  99.3608767 #>  7:     7     1     0  99.9500351 #>  8:     8     0     0  -0.2514834 #>  9:     9     0     0   0.4447971 #> 10:    10     0     0   2.7554176  # rename outcome variable trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) {     data.frame(yy = with(data, rnorm(nrow(data), a * ate)))   } ) trial$simulate(n) #>        id     a   num          yy #>     <num> <int> <num>       <num> #>  1:     1     1     0 -0.24323674 #>  2:     2     1     0 -0.20608719 #>  3:     3     1     0  0.01917759 #>  4:     4     0     0  0.02956075 #>  5:     5     1     0  0.54982754 #>  6:     6     1     0 -2.27411486 #>  7:     7     0     0  2.68255718 #>  8:     8     0     0 -0.36122126 #>  9:     9     1     0  0.21335575 #> 10:    10     1     0  1.07434588  # return multiple outcome variables trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), y.base = rnorm(n)),   outcome = \\(data, ate = 0) {     y  <-  with(data, rnorm(nrow(data), a * ate))     return(data.frame(y = y, y.chg = data$y.base - y))   } ) trial$simulate(n) #>        id     a     y.base   num           y      y.chg #>     <num> <int>      <num> <num>       <num>      <num> #>  1:     1     0  1.0650573     0  0.60674805  0.4583093 #>  2:     2     1  0.1316706     0 -0.10993567  0.2416063 #>  3:     3     1  0.4886288     0  0.17218172  0.3164471 #>  4:     4     0 -1.6994506     0 -0.09032729 -1.6091233 #>  5:     5     0 -1.4707363     0  1.92434334 -3.3950796 #>  6:     6     1  0.2841503     0  1.29839276 -1.0142424 #>  7:     7     0  1.3373204     0  0.74879127  0.5885291 #>  8:     8     0  0.2366963     0  0.55622433 -0.3195280 #>  9:     9     0  1.3182934     0 -0.54825726  1.8665506 #> 10:    10     1  0.5239098     0  1.11053489 -0.5866251  # use exclusion argument to post-process sampled outcome variable to # achieve the same as in the above example but without modifying the # originally defined outcome model trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), y.base = rnorm(n)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   exclusion = \\(data) {    cbind(data, data.frame(y.chg = data$y.base - data$y))   } ) trial$simulate(n) #>        id     a      y.base   num          y      y.chg #>     <num> <int>       <num> <num>      <num>      <num> #>  1:     1     0  1.06310200     0 -0.7854327  1.8485347 #>  2:     2     1  1.04871262     0 -1.0567369  2.1054495 #>  3:     3     0 -0.03810289     0 -0.7955414  0.7574385 #>  4:     4     1  0.48614892     0 -1.7562754  2.2424243 #>  5:     5     1  1.67288261     0 -0.6905379  2.3634205 #>  6:     6     0 -0.35436116     0 -0.5585420  0.2041808 #>  7:     7     0  0.94634789     0 -0.5366633  1.4830112 #>  8:     8     1  1.31682636     0  0.2271271  1.0896992 #>  9:     9     1 -0.29664002     0  0.9784549 -1.2750949 #> 10:    10     0 -0.38721358     0 -0.2088827 -0.1783309  # no covariate model trial <- Trial$new(   outcome = \\(data, ate = 0) {     n <- nrow(data)     a <- rbinom(n, 1, 0.5)     return(data.frame(a = a, y = rnorm(n, a * ate)))   } ) trial$simulate(n) #>        id     a           y #>     <num> <int>       <num> #>  1:     1     0  0.42485844 #>  2:     2     1 -1.68428153 #>  3:     3     1  0.24940178 #>  4:     4     1  1.07283825 #>  5:     5     0  2.03936926 #>  6:     6     1  0.44945378 #>  7:     7     1  1.39181405 #>  8:     8     1  0.42656655 #>  9:     9     1  0.10758399 #> 10:    10     0  0.02229473  ## ------------------------------------------------ ## Method `Trial$run` ## ------------------------------------------------  # future::plan(\"multicore\") trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   estimators = list(glm = est_glm()) ) trial$args_summary(alternative = \"<\")  # the returned trial.estimates object contains the estimates for each of # the R simulated data sets + all necessary information to re-run the # simulation res <- trial$run(n = 100, R = 50) # store return object in a new variable print(trial$estimates) # trial$estimates == res #> ── trial.estimates ──  #>  #> Model arguments:  #> Estimators: glm #> Simulation parameters: n = 100, R = 50 #>  #> Sample data: #>       id     a   num          y #>    <num> <int> <num>      <num> #> 1:     1     1     0 -0.4738871 #> 2:     2     1     0 -1.2753349 #> 3:     3     0     0 -0.3056207 #> 4:     4     1     0  2.2117695 #> 5:     5     0     0 -1.0416684 #> 6:     6     0     0 -1.1465239  # the basic usage is to apply the summary method to the generated # trial.estimates object. trial$summary() #>      estimate   std.err  std.dev power na #> glm 0.0148037 0.1998015 0.211798  0.04  0  # combining Trial$run and summary is faster than using # Trial$estimate_power when modifying only the parameters of the # decision-making function sapply(   c(0, 0.25, 0.5),   \\(ni) trial$summary(ni.margin = ni)[, \"power\"] ) #> [1] 0.08 0.32 0.74  # changing the ate parameter value trial$run(n = 100, R = 50, ate = -0.2)  # supplying another estimator trial$run(n = 100, R = 50, estimators = est_glm(robust = FALSE))  ## ------------------------------------------------ ## Method `Trial$estimate_power` ## ------------------------------------------------  # toy examples with small number of Monte-Carlo replicates # future::plan(\"multicore\") trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate = 0) with(data, rnorm(nrow(data), a * ate)),   estimators = list(glm = est_glm()) ) trial$args_summary(alternative = \"<\")  # using previously defined estimators and summary.args trial$estimate_power(n = 100, R = 20) #> [1] 0.05  # supplying parameters to outcome function trial$estimate_power(n = 100, R = 20, ate = -100) #> [1] 1  # modifying arguments of summary function trial$estimate_power(n = 100, R = 20, ate = -100,  summary.args = list(alternative = \">\") ) #> [1] 0  # supplying estimators to overrule previously set estimators trial$estimate_power(n = 100, R = 20,  estimators = list(est_glm(), est_adj())) #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> Warning: partial argument match of 'X.cat' to 'X.cate' #> est1 est2  #>  0.1  0.1   ## ------------------------------------------------ ## Method `Trial$estimate_samplesize` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = \\(data, ate, sd) with(data, rnorm(nrow(data), a * ate, sd)),   estimators = list(marginal = est_glm()) ) trial$args_model(ate = -1, sd = 5) trial$args_summary(alternative = \"<\")  # supply model parameter and estimator to call to overwrite previously # set values trial$estimate_samplesize(ate = -2, estimator = est_glm())  # reduce number of iterations for bisection step but keep R = 100 # (default value) trial$estimate_samplesize(bisection.control = list(niter = 2))  # reduce significance level from 0.05 to 0.025, but keep alternative as # before trial$estimate_samplesize(summary.args = list(level = 0.025)) } # }  ## ------------------------------------------------ ## Method `Trial$print` ## ------------------------------------------------  trial <- Trial$new(   covariates = function(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = function(data, sd = 1) rnorm(nrow(data), data$a * -1, sd),   estimators = list(marginal = est_glm()),   info = \"Some trial info\" ) trial$args_model(sd = 2) trial$args_summary(level = 0.025)  print(trial) # only function headers #> ── Trial Object ──  #> Some trial info  #>  #> Model arguments:   #>  • sd:  num 2 #>  #> Summary arguments:   #>  • level:  num 0.025 #>  #> Covariates: #>  function (n, ...)    #>  #> Outcome: #>  function (data, sd = 1, ...)    #>  #> Exclusion: #>  function (x, ...)    #>  #> Estimators: #>   1. marginal  #> ──────────────────── print(trial, verbose = TRUE) # also print function bodies #> ── Trial Object ──  #> Some trial info  #>  #> Model arguments:   #>  • sd:  num 2 #>  #> Summary arguments:   #>  • level:  num 0.025 #>  #> Covariates: #>   function (n, ...)   #>     data.frame(a = rbinom(n, 1, 0.5))  #>  #> Outcome: #>   function (data, sd = 1, ...)   #>     rnorm(nrow(data), data$a * -1, sd)  #>  #> Exclusion: #>   function (x, ...)   #>     x  #>  #> Estimators: #>   1. marginal  #> ────────────────────"},{"path":"https://novonordisk-opensource.github.io/carts/reference/aggrsurv.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate data in counting process format — aggrsurv","title":"Aggregate data in counting process format — aggrsurv","text":"Aggregate data counting process format. aggregation done within subject .","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/aggrsurv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate data in counting process format — aggrsurv","text":"","code":"aggrsurv(   data,   breaks,   entry = \"entry\",   exit = \"exit\",   status = \"status\",   id = \"id\",   names = c(\"episode\", \"entry\", \"exit\", \"events\", \"exposure\"),   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/aggrsurv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate data in counting process format — aggrsurv","text":"data data.frame breaks vector time points entry name entry date variable exit name exit date variable status censoring / event variable id id variable names character vector names new variables ... additional arguments lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/aggrsurv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate data in counting process format — aggrsurv","text":"data.table","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/aggrsurv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate data in counting process format — aggrsurv","text":"","code":"dat <- data.table::data.table(   id = c(1, 1, 1, 1, 2, 2, 2),   entry = as.Date(c(     \"2021-01-01\", \"2021-01-20\", \"2021-02-28\", \"2021-06-01\",     \"2021-01-01\", \"2021-01-14\", \"2021-09-01\"  )),   status = c(1, 1, 1, 1, 1, 1, 0),   x = rnorm(7) ) dat[, exit := data.table::shift(entry, 1, type=\"lead\"), by=id] #>       id      entry status           x       exit #>    <num>     <Date>  <num>       <num>     <Date> #> 1:     1 2021-01-01      1 -1.36221146 2021-01-20 #> 2:     1 2021-01-20      1 -0.23588055 2021-02-28 #> 3:     1 2021-02-28      1 -1.24925745 2021-06-01 #> 4:     1 2021-06-01      1  1.32667946       <NA> #> 5:     2 2021-01-01      1 -0.70975219 2021-01-14 #> 6:     2 2021-01-14      1  0.83703685 2021-09-01 #> 7:     2 2021-09-01      0  0.06299967       <NA> dat[, exit := replace(exit, .N, as.Date(\"2021-12-31\")),      by = id] #>       id      entry status           x       exit #>    <num>     <Date>  <num>       <num>     <Date> #> 1:     1 2021-01-01      1 -1.36221146 2021-01-20 #> 2:     1 2021-01-20      1 -0.23588055 2021-02-28 #> 3:     1 2021-02-28      1 -1.24925745 2021-06-01 #> 4:     1 2021-06-01      1  1.32667946 2021-12-31 #> 5:     2 2021-01-01      1 -0.70975219 2021-01-14 #> 6:     2 2021-01-14      1  0.83703685 2021-09-01 #> 7:     2 2021-09-01      0  0.06299967 2021-12-31  res <- aggrsurv(dat,   breaks = c(182),   entry = \"entry\", exit = \"exit\", status = \"status\", id = \"id\" ) print(res) #> Key: <id> #>       id episode entry  exit events exposure          x #>    <num>   <num> <num> <num>  <num>    <num>      <num> #> 1:     1       1     0   182      3      182 -1.3622115 #> 2:     1       2   182   364      1      182 -1.3622115 #> 3:     2       1     0   182      1      182 -0.7097522 #> 4:     2       2   182   364      1      182 -0.7097522"},{"path":"https://novonordisk-opensource.github.io/carts/reference/append-set-.list.html","id":null,"dir":"Reference","previous_headings":"","what":"Assignment function to append values to existing list — append<-.list","title":"Assignment function to append values to existing list — append<-.list","text":"Assignment function append values existing list","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/append-set-.list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assignment function to append values to existing list — append<-.list","text":"","code":"# S3 method for class 'list' append(x, name = NULL) <- value"},{"path":"https://novonordisk-opensource.github.io/carts/reference/append-set-.list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assignment function to append values to existing list — append<-.list","text":"x existing list name optional name new element value new value add existing list","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/append-set-.list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assignment function to append values to existing list — append<-.list","text":"","code":"x <- list() append(x) <- 1 append(x, name = \"a\") <- 2 # duplicated names are allowed append(x, name = \"a\") <- 3 x #> [[1]] #> [1] 1 #>  #> $a #> [1] 2 #>  #> $a #> [1] 3 #>"},{"path":"https://novonordisk-opensource.github.io/carts/reference/bisection.html","id":null,"dir":"Reference","previous_headings":"","what":"Root finding by bisection — bisection","title":"Root finding by bisection — bisection","text":"Root finding bisection","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/bisection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Root finding by bisection — bisection","text":"","code":"bisection(f, interval, niter = 6, tol = 1e-12, verbose = TRUE, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/bisection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Root finding by bisection — bisection","text":"f function find root (monotonic) interval vector containing end-points interval searched root niter number iterations tol stopping criterion (absolute difference function evaluated end points current interval) verbose TRUE additional messages printed throughout optimization ... additional arguments passed f","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/bisection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Root finding by bisection — bisection","text":"numeric specifying root","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/bisection.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Root finding by bisection — bisection","text":"","code":"testf <- function(x) (x - sqrt(2)) carts:::bisection(testf, c(0, 1000), niter = 30) #> INFO [2025-11-03 09:51:39] Evaluating left point: 0 #> INFO [2025-11-03 09:51:39] Evaluating right point: 1000 #> INFO [2025-11-03 09:51:39] Evaluating mid point: 500  [iteration 1/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 250  [iteration 2/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 125  [iteration 3/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 62.5  [iteration 4/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 31.25  [iteration 5/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 15.625  [iteration 6/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 7.8125  [iteration 7/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 3.90625  [iteration 8/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.953125  [iteration 9/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 0.9765625  [iteration 10/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.46484375  [iteration 11/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.220703125  [iteration 12/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.3427734375  [iteration 13/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.40380859375  [iteration 14/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.434326171875  [iteration 15/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.4190673828125  [iteration 16/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41143798828125  [iteration 17/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41525268554688  [iteration 18/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41334533691406  [iteration 19/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41429901123047  [iteration 20/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41382217407227  [iteration 21/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41406059265137  [iteration 22/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41417980194092  [iteration 23/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41423940658569  [iteration 24/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41420960426331  [iteration 25/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.4142245054245  [iteration 26/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.4142170548439  [iteration 27/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.4142133295536  [iteration 28/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41421519219875  [iteration 29/30] #> INFO [2025-11-03 09:51:39] Evaluating mid point: 1.41421426087618  [iteration 30/30] #> [1] 1.414214"},{"path":"https://novonordisk-opensource.github.io/carts/reference/carts-package.html","id":null,"dir":"Reference","previous_headings":"","what":"carts: Simulation-Based Assessment of Covariate Adjustment in Randomized Trials — carts-package","title":"carts: Simulation-Based Assessment of Covariate Adjustment in Randomized Trials — carts-package","text":"Monte Carlo simulation framework different randomized clinical trial designs special emphasis estimators based covariate adjustment. Monte Carlo simulation framework different randomized clinical trial designs special emphasis estimators based covariate adjustment.","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/carts-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"carts: Simulation-Based Assessment of Covariate Adjustment in Randomized Trials — carts-package","text":"Maintainer: Benedikt Sommer benediktsommer92@gmail.com Authors: Klaus K. Holst klaus@holst.Foroogh Shamsi foroogh.shamsi1@gmail.com Benedikt Sommer, Klaus Holst, Foroogh Shamsi","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/carts-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"carts: Simulation-Based Assessment of Covariate Adjustment in Randomized Trials — carts-package","text":"","code":"if (FALSE) { # \\dontrun{ trial <- Trial$new(   covariates = \\(n) data.frame(a = rbinom(n, 1, 0.5), x = rnorm(n)),   outcome = setargs(outcome_count, par = c(1, 0.5, 1), overdispersion = 0.7) )  trial$estimators(   unadjusted = est_glm(family = \"poisson\"),   adjusted = est_glm(family = \"poisson\", covariates = \"x\") )  trial$run(n = 200, R = 100) trial$summary() } # }"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":null,"dir":"Reference","previous_headings":"","what":"Add additional covariates to existing list of covariates — covar_add","title":"Add additional covariates to existing list of covariates — covar_add","text":"use Trial objects, function makes possible easily add additional covariates existing list covariates (form data.frame data.table).","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add additional covariates to existing list of covariates — covar_add","text":"","code":"covar_add(covars, x, names = NULL, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add additional covariates to existing list of covariates — covar_add","text":"covars list covariates (data.frame's data.table's) x new covariates (function list functions/scalars) names optional names new covariates ... additional arguments function x functions x","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add additional covariates to existing list of covariates — covar_add","text":"matching format covariates covars","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add additional covariates to existing list of covariates — covar_add","text":"Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_add.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add additional covariates to existing list of covariates — covar_add","text":"","code":"# adding \"fixed\" treatment indicator in each period n <- 5 xt <- function(n, ...) {  covar_loggamma(n, normal.cor = 0.2) |>    covar_add(list(a = 0, a = 1)) } xt(n) #> $`0` #>               z     a #>           <num> <num> #> 1: -1.314957908     0 #> 2:  0.437148133     0 #> 3:  0.886258819     0 #> 4:  0.008682371     0 #> 5:  0.016494232     0 #>  #> $`1` #>              z     a #>          <num> <num> #> 1: -0.14046420     1 #> 2:  0.48415947     1 #> 3: -3.25286323     1 #> 4: -0.11741507     1 #> 5:  0.01759809     1 #>  # adding randomized treatment indicator xt <- function(n, ...) {  covar_loggamma(n, normal.cor = 0.2) |>    covar_add(list(a = rbinom(n, 1, 0.5), a = rbinom(n, 1, 0.5))) } xt(5) #> $`0` #>              z     a #>          <num> <int> #> 1:  0.27939160     0 #> 2:  1.23280250     1 #> 3: -2.81056202     1 #> 4:  1.07608473     1 #> 5:  0.07663859     0 #>  #> $`1` #>             z     a #>         <num> <int> #> 1:  0.1135722     1 #> 2:  1.6015547     0 #> 3: -0.5877852     1 #> 4: -0.4335034     1 #> 5:  1.1675433     0 #>  # adding baseline covariates xt <- function(n, ...) {  covar_loggamma(n, normal.cor = 0.2) |>    covar_add(rnorm(n), names = \"w1\") |> # data    covar_add(list(w2 = rnorm(n))) |> # data    covar_add(data.frame(w3 = rnorm(n))) |> # data    covar_add(\\(n) data.frame(w4 = rnorm(n))) |> # function    covar_add(\\(n) rnorm(n), names = \"w5\") # function } xt(5) #> $`0` #>             z         w1         w2         w3          w4           w5 #>         <num>      <num>      <num>      <num>       <num>        <num> #> 1: -1.1597797  0.1384708  1.2362631 -0.1609534 -0.54531347  0.403167147 #> 2:  0.1252903 -1.8252874  0.8806714 -0.1733009  0.08089318  0.008137872 #> 3: -2.5187935  1.1037974  0.9313603 -0.2917484 -0.36807541 -0.356770804 #> 4: -0.4206908  0.7713715  1.3684064  2.2466688  0.45485114  0.494554007 #> 5:  1.4236045  0.9091486 -1.5394573  0.3710951 -0.27716448  1.035993007 #>  #> $`1` #>             z         w1         w2         w3          w4           w5 #>         <num>      <num>      <num>      <num>       <num>        <num> #> 1: -0.3529190  0.1384708  1.2362631 -0.1609534 -0.54531347  0.403167147 #> 2: -1.4938520 -1.8252874  0.8806714 -0.1733009  0.08089318  0.008137872 #> 3: -0.8087580  1.1037974  0.9313603 -0.2917484 -0.36807541 -0.356770804 #> 4:  0.4098094  0.7713715  1.3684064  2.2466688  0.45485114  0.494554007 #> 5:  0.9904463  0.9091486 -1.5394573  0.3710951 -0.27716448  1.035993007 #>"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from empirical distribution of covariate data — covar_bootstrap","title":"Sample from empirical distribution of covariate data — covar_bootstrap","text":"Sample empirical distribution covariate data","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from empirical distribution of covariate data — covar_bootstrap","text":"","code":"covar_bootstrap(data, subset = NULL)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from empirical distribution of covariate data — covar_bootstrap","text":"data data.frame subset optional columns select data frame","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from empirical distribution of covariate data — covar_bootstrap","text":"random generator (function)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_join.html","id":null,"dir":"Reference","previous_headings":"","what":"Add additional covariates to existing covariate random generator — covar_join","title":"Add additional covariates to existing covariate random generator — covar_join","text":"use Trial objects, function makes possible easily add additional covariates existing random generator (function(n ...) returning data.frame data.table)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_join.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add additional covariates to existing covariate random generator — covar_join","text":"","code":"covar_join(f, ...)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_join.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add additional covariates to existing covariate random generator — covar_join","text":"f covariate random generator ... additional covariate generators constant covariates","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_join.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add additional covariates to existing covariate random generator — covar_join","text":"function, returned data type matching f","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_join.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add additional covariates to existing covariate random generator — covar_join","text":"","code":"# single period n <- 5 c1 <- function(n) data.frame(a = rnorm(n)) c2 <- function(n) data.frame(b = rnorm(n)) x <- c1 %join% c2 x(n) #>            a          b #> 1 0.04669757  0.1507861 #> 2 0.59032683  0.3785929 #> 3 0.30337304 -0.3930904 #> 4 0.14815437 -0.7093823 #> 5 0.98972679 -1.9185240  # adding covariates that remain constant when sampling x <- c1 %join% data.frame(b = rnorm(n)) all.equal(x(n)$b, x(n)$b) #> [1] TRUE  # adding multiple anonymous functions require parenthesis enclosing, with # the exception of the last function x <- c1 %join%  (\\(n) data.frame(b = rnorm(n))) %join%  \\(n) data.frame(c = rnorm(n)) x(n) #>            a           b          c #> 1  0.7249908  2.03099281 -0.1838404 #> 2 -0.2001866 -0.20509789 -0.8137313 #> 3 -0.9472671 -0.95129804  0.8461623 #> 4  0.8113895 -0.32001446 -0.8480619 #> 5  0.4882053 -0.01238079 -0.9808207  # multiple periods base <- setargs(covar_loggamma, normal.cor = .5) x <- base %join%   function(n) list(       data.frame(a = rbinom(n, 1, 0.5)),       data.frame(a = rbinom(n, 1, 0.5))     ) x(n) #> $`0` #>             z     a #>         <num> <int> #> 1: -1.4202984     1 #> 2: -1.2336152     0 #> 3:  0.3128252     1 #> 4:  1.3156041     1 #> 5:  0.4057674     1 #>  #> $`1` #>            z     a #>        <num> <int> #> 1: 0.8342020     1 #> 2: 0.5459076     1 #> 3: 0.1672391     0 #> 4: 1.2885719     1 #> 5: 0.4981557     1 #>   # constant covariate x <- base %join% list(data.frame(a = 0), data.frame(a = 1)) x(n) #> $`0` #>             z     a #>         <num> <num> #> 1:  0.9465897     0 #> 2: -0.5514598     0 #> 3: -2.2072006     0 #> 4:  0.7969517     0 #> 5:  0.7071314     0 #>  #> $`1` #>              z     a #>          <num> <num> #> 1: -0.09164136     1 #> 2:  0.88326286     1 #> 3: -1.60134193     1 #> 4: -0.35968743     1 #> 5: -0.49825956     1 #>   # baseline covariate x <- base %join% function(n) data.frame(w = rnorm(n)) x(n) #> $`0` #>             z            w #>         <num>        <num> #> 1: -0.9839422 -0.008852818 #> 2:  0.9476139  0.179429002 #> 3:  0.3040516 -0.227400111 #> 4: -1.9971830 -1.010783848 #> 5:  0.1878676  1.392029481 #>  #> $`1` #>             z            w #>         <num>        <num> #> 1: -4.1980728 -0.008852818 #> 2:  1.5222202  0.179429002 #> 3:  0.6118440 -0.227400111 #> 4:  0.2246414 -1.010783848 #> 5: -0.5930002  1.392029481 #>"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_loggamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","title":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","text":"Simulate logarithmic transform Gaussian copula model compound symmetry correlation structure Gamma distributed marginals mean one.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_loggamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","text":"","code":"covar_loggamma(   n,   normal.cor = NULL,   gamma.var = 1,   names = c(\"z\"),   type = \"cs\",   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_loggamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","text":"n Number samples normal.cor Correlation parameter (n x r) (1 x r) matrix gamma.var Variance gamma distribution (n x p 1 x p matrix) names Column name column vector (default \"z\") type correlation matrix structure (cs: compound-symmetry / exchangable, ar: autoregressive, un: unstructured, : toeplitz). dimension normal.cor must match, .e., Toeplitz correlation matrix r = p-1, cs ar r=1. ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_loggamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","text":"list data.tables","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_loggamma.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate from a log gamma-gaussian copula distribution — covar_loggamma","text":"simulate Gaussian copula first drawing \\(X\\sim   N(0,R)\\) transform margins \\(x\\mapsto   \\log(F_\\nu^{-1}\\{\\Phi(x)\\})\\) \\(\\Phi\\) standard normal CDF \\(F_\\nu^{-1}\\) quantile function Gamma distribution scale rate parameter equal \\(\\nu\\).","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from multivariate normal distribution — covar_normal","title":"Simulate from multivariate normal distribution — covar_normal","text":"Simulate MVN compound symmetry variance structure mean zero. result returned list ith element column vector n observations ith coordinate MVN.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from multivariate normal distribution — covar_normal","text":"","code":"covar_normal(   n,   normal.cor = NULL,   normal.var = 1,   names = c(\"z\"),   type = \"cs\",   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from multivariate normal distribution — covar_normal","text":"n Number samples normal.cor Correlation parameter (n x r) (1 x r) matrix normal.var marginal variance (can specified p-dim. vector nxp matrix) names Column name column vector (default \"z\") type correlation matrix structure (cs: compound-symmetry / exchangable, ar: autoregressive, un: unstructured, : toeplitz). dimension normal.cor must match, .e., Toeplitz correlation matrix r = p-1, cs ar r=1. ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/covar_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from multivariate normal distribution — covar_normal","text":"list data.tables","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/derive_covar_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive covariate distribution from covariate data type — derive_covar_distribution","title":"Derive covariate distribution from covariate data type — derive_covar_distribution","text":"Derive covariate distribution (outcome regression) integers (Poisson), numeric (Gaussian) binary (Binomial) data. Raise error data types.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/derive_covar_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive covariate distribution from covariate data type — derive_covar_distribution","text":"","code":"derive_covar_distribution(covar)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/derive_covar_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive covariate distribution from covariate data type — derive_covar_distribution","text":"covar Vector covariates","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/derive_covar_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive covariate distribution from covariate data type — derive_covar_distribution","text":"lava package random generator function","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/derive_covar_distribution.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Derive covariate distribution from covariate data type — derive_covar_distribution","text":"Benedikt Sommer","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"Efficient estimator treatment effect based efficient influence function. involves model conditional mean outcome variable given covariates.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"","code":"est_adj(   response = \"y\",   treatment = \"a\",   covariates = NULL,   offset = NULL,   id = NULL,   family = gaussian(),   level = 0.95,   treatment.effect = NULL,   nfolds = 1,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"response Response variable (character) treatment Treatment variable (character) covariates Optional covariates (character) offset Optional offset (character) id Optional subject id variable (character) family Exponential family (default gaussian) level Confidence interval level treatment.effect (optional) function describing treatment effect given mean potential outcomes. Default average treatment effect (difference expected outcome, (x,y) -> (y-x)) unless family binomial poisson, case treatment effect difference log expected outcomes (x,y) -> log(y/x). nfolds Number folds estimating conditional average treatment effect double machine learning. ... Additional arguments targeted::learner_glm","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"function","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"...","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_adj.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Construct estimator for the treatment effect in RCT based on covariate adjustment — est_adj","text":"Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct estimator for the treatment effect in RCT — est_glm","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"Returns estimator estimation treatment effect parametric models (stats::glm MASS::glm.nb). returned estimator function single argument (data) returns treatment effect estimate, estimated lava::estimate","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"","code":"est_glm(   response = \"y\",   treatment = \"a\",   covariates = NULL,   offset = NULL,   id = NULL,   level = 0.95,   family = gaussian(),   target.parameter = treatment,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"response (character) Response variable treatment (character) Treatment variable covariates (character; optional) Single vector covariates offset (character; optional) Model offset id (character; optional) Subject id variable level (numeric) Confidence interval level family (family character) Exponential family supported stats::glm MASS::glm.nb target.parameter (character) Target parameter model output ... Additional arguments lava::estimate","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"function","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct estimator for the treatment effect in RCT — est_glm","text":"","code":"trial <- Trial$new(     covariates = function(n) data.frame(a = rbinom(n, 1, 0.5), x = rnorm(n)),     outcome = setargs(outcome_count,       mean = ~ 1 + a*x,       par = c(1, -0.1, 0.5, 0.2),       overdispersion = 2) ) dd <- trial$simulate(3e2)  # crude mean comparison between arms (default behavior; y ~ a) est <- est_glm(family = poisson) est(dd) #>   Estimate Std.Err    2.5%  97.5% P-value #> a  -0.1584  0.1915 -0.5337 0.2169  0.4082  # linear adjustment with one covariate (y ~ a + x) est <- est_glm(family = poisson, covariates = \"x\") est(dd) #>   Estimate Std.Err    2.5%  97.5% P-value #> a  -0.2085  0.1848 -0.5706 0.1537  0.2593  # return estimates of all linear coefficients (useful for debugging) est <- est_glm(family = poisson, covariates = \"x\", target.parameter = NULL) est(dd) #>             Estimate Std.Err    2.5%  97.5%   P-value #> (Intercept)   1.3372 0.12877  1.0848 1.5896 2.909e-25 #> a            -0.2085 0.18478 -0.5706 0.1537 2.593e-01 #> x             0.4094 0.08995  0.2331 0.5857 5.338e-06  # comparing robust and non-robust standard errors of poisson estimator by # passing robust argument via ... to lava::estimate estimators <- list(   robust = est_glm(family = poisson),   non.robust = est_glm(family = poisson, robust = FALSE) ) res <- do.call(rbind, lapply(estimators, \\(est) est(dd)$coefmat)) rownames(res) <- names(estimators) res #>              Estimate    Std.Err       2.5%       97.5%     P-value #> robust     -0.1583593 0.19148563 -0.5336642  0.21694563 0.408235025 #> non.robust -0.1583593 0.05994537 -0.2758501 -0.04086853 0.008248453"},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_phreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","title":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","text":"Marginal Cox proportional hazards model treatment effect RCT","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_phreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","text":"","code":"est_phreg(   response = \"Surv(time, status)\",   treatment = \"a\",   level = 0.95,   id = NULL )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_phreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","text":"response Response variable (character formula). Default: \"Surv(time, status)\" treatment Treatment variable (character) level Confidence interval level id Optional subject id variable (character)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_phreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","text":"function","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/est_phreg.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Marginal Cox proportional hazards model for the treatment effect in RCT — est_phreg","text":"Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":null,"dir":"Reference","previous_headings":"","what":"Full conditional covariate simulation model — estimate_covar_model_full_cond","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"Estimates full conditional model approximate joint distribution covariate data. factor \\(p(x_i | x_1, \\dots x_{-1})\\) modelled glm, mean \\(E[x_i | x_1, \\dots x_{-1}] = g^{-1}(\\beta_0 + \\sum_{j=1}^{-1}\\beta_j x_j)\\). parametric distribution factor either derived column type (see derive_covar_distribution) specified cond.dist.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"","code":"estimate_covar_model_full_cond(data, cond.dist = NULL)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"data Covariate data.table cond.dist list random generator functions conditional distribution covariate","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"lava::lvm object estimated coefficients","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"Benedikt Sommer","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/estimate_covar_model_full_cond.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Full conditional covariate simulation model — estimate_covar_model_full_cond","text":"","code":"data <- data.table::data.table( y = as.factor(rbinom(1e3, size = 1, prob=0.1)) )  # infer distribution of y from column type m.est <- estimate_covar_model_full_cond(data) y <- sample_covar_parametric_model(1e4, m.est)$y |> as.integer() - 1 print(mean(y)) #> [1] 0.0931  # specify distribution of y m.est <- estimate_covar_model_full_cond(   data, cond.dist = list(y = binomial.lvm) ) y <- sample_covar_parametric_model(1e4, m.est)$y |> as.integer() - 1 print(mean(y)) #> [1] 0.0938"},{"path":"https://novonordisk-opensource.github.io/carts/reference/get_factor_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"Get levels for factor columns in data.table — get_factor_levels","title":"Get levels for factor columns in data.table — get_factor_levels","text":"Get levels factor columns data.table","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/get_factor_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get levels for factor columns in data.table — get_factor_levels","text":"","code":"get_factor_levels(data)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/get_factor_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get levels for factor columns in data.table — get_factor_levels","text":"data Covariate data.table","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/optim_sa.html","id":null,"dir":"Reference","previous_headings":"","what":"Root solver by Stochastic Approximation — optim_sa","title":"Root solver by Stochastic Approximation — optim_sa","text":"Root solver Stochastic Approximation","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/optim_sa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Root solver by Stochastic Approximation — optim_sa","text":"","code":"optim_sa(   f,   init = 0,   function.args = list(),   ...,   method = c(\"standard\", \"discrete\", \"interpolate\"),   projection = identity,   control = list(niter = 100, alpha = 0.25, stepmult = 1),   verbose = TRUE,   burn.in = 0.75 )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/optim_sa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Root solver by Stochastic Approximation — optim_sa","text":"f Stochastic function init Initial value evaluate f function.args Additional arguments passed f ... Additional arguments passed f method Method ('standard': standard Robbins-Monro, 'discrete' 'interpolate' integer stochastic optimization. See details section) projection Optional projection function can used constrain parameter value (e.g., function(x) max(x, tau)). Applied end iteration optimization. control Control arguments (niter number iterations, alpha stepmult control step-length Polyak-Ruppert algorithm described details section). verbose TRUE additional messages printed throughout optimization burn.Burn-(fraction initial values disregard) applying Polyak–Ruppert averaging (alpha<1). Alternatively, burn.can given integer defining absolut number iterations disregard.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/optim_sa.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Root solver by Stochastic Approximation — optim_sa","text":"aim find root function \\( M(\\theta) = E   f(\\theta)\\), able observe stochastic function \\(f(\\theta)\\). assume $M$ non-decreasing unique root \\(\\theta^\\ast\\). Robbins-Monro algorithm works following update rule initial start value \\(\\theta_0\\): $$\\theta_{n+1} = \\theta_{n} - a_n f(\\theta_n)$$ \\(\\sum_{n=0}^\\infty a_n = \\infty\\) \\(\\sum_{n=0}^\\infty a_n^2 <   \\infty\\). averaging iterates $$\\overline{\\theta}_n = \\frac{1}{n}\\sum_{=1}^{n-1}\\theta_i$$ can get improved stability algorithm less sensitive choice step-length \\(a_n\\). known Polyak-Ruppert algorithm ensure convergence longer step sizes must made can guaranteed using \\(a_n = Kn^{-\\alpha}\\) \\(0<\\alpha<1\\). parameters \\(K\\) \\(\\alpha\\) controlled stepmult alpha parameters control argument. discrete problems \\(\\theta\\) must integer, follow (Dupac & Herkenrath, 1984). Let \\(\\lfloor x\\rfloor\\) denote integer part \\(x\\), define either (method=\"discrete\"): $$g(\\theta) = (U<\\theta-\\lfloor\\theta\\rfloor)f(\\lfloor\\theta\\rfloor) + (U\\geq\\theta-\\lfloor\\theta\\rfloor)f(\\lfloor\\theta\\rfloor+1)$$ \\(U\\sim Uniform([0,1])\\), (method=\"interpolate\"): $$g(\\theta) = (1-\\theta+\\lfloor\\theta\\rfloor)f(\\lfloor\\theta\\rfloor) + (\\theta-\\lfloor\\theta\\rfloor)f(\\lfloor\\theta\\rfloor+1).$$ stochastic approximation method applied directly \\(g\\). Dupač, V., & Herkenrath, U. (1984). integer stochastic approximation. Aplikace matematiky, 29(5), 372-383.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/optim_sa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Root solver by Stochastic Approximation — optim_sa","text":"","code":"# Finding approximate median u, P(X<=u) = .5, of X~Exp(1): f <- function(x) mean(rexp(10) <= x) - 0.5 res <- carts:::optim_sa(f, 0, control=list(niter=2000, alpha=.5)) res$estimate #> [1] 0.6800497"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_binary.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from binary model given covariates — outcome_binary","title":"Simulate from binary model given covariates — outcome_binary","text":"Simulate binary model probability $$\\pi =   g(\\text{par}^\\top X)$$ \\(X\\) design matrix specified formula, \\(g\\) link function specified family argument","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_binary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from binary model given covariates — outcome_binary","text":"","code":"outcome_binary(   data,   mean = NULL,   par = NULL,   outcome.name = \"y\",   remove = c(\"id\", \"num\"),   family = binomial(logit),   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_binary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from binary model given covariates — outcome_binary","text":"data covariate matrix mean formula specifying design 'data' function maps x mean value. NULL main-effects covariates used par Regression coefficients (default zero). Can given named list corresponding column names model.matrix outcome.name Name outcome variable (\"y\") remove variables removed input x (formula specified) family exponential family (default binomial(logit)) ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_binary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from binary model given covariates — outcome_binary","text":"data.table","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_continuous.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from continuous outcome model given covariates — outcome_continuous","title":"Simulate from continuous outcome model given covariates — outcome_continuous","text":"Simulate continuous outcome model mean $$g(\\text{par}^\\top X)$$ \\(X\\) design matrix specified formula, \\(g\\) link function specified family argument","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_continuous.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from continuous outcome model given covariates — outcome_continuous","text":"","code":"outcome_continuous(   data,   mean = NULL,   par = NULL,   sd = 1,   het = 0,   outcome.name = \"y\",   remove = c(\"id\", \"num\"),   family = gaussian(),   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_continuous.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from continuous outcome model given covariates — outcome_continuous","text":"data covariate matrix mean formula specifying design 'data' function maps x mean value. NULL main-effects covariates used par Regression coefficients (default zero). Can given named list corresponding column names model.matrix sd standard deviation measurement error het Introduce variance hetereogeneity adding residual term \\(het \\cdot \\mu_x \\cdot e\\), \\(\\mu_x\\) mean given covariates \\(e\\) independent standard normal distributed variable. term addition measurement error introduced sd argument. outcome.name Name outcome variable (\"y\") remove variables removed input x (formula specified) family exponential family (default gaussian(identity)) ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_continuous.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from continuous outcome model given covariates — outcome_continuous","text":"data.table","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_count.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from count model given covariates — outcome_count","title":"Simulate from count model given covariates — outcome_count","text":"Simulate count model intensity $$\\lambda =   \\text{exposure-time}\\exp(\\text{par}^\\top X)$$ \\(X\\) design matrix specified formula","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from count model given covariates — outcome_count","text":"","code":"outcome_count(   data,   mean = NULL,   par = NULL,   outcome.name = \"y\",   exposure = 1,   remove = c(\"id\", \"num\"),   zero.inflation = NULL,   overdispersion = NULL,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from count model given covariates — outcome_count","text":"data covariate matrix mean formula specifying design 'x' function maps x mean value. NULL main-effects covariates used. par Regression coefficients (default zero). Can given named list corresponding column names model.matrix outcome.name Name outcome variable (\"y\") exposure Exposure times. Either scalar, vector function. remove Variables removed input x (formula specified) zero.inflation vector probabilities function covariates 'x' including extra column 'rate' rate parameter. overdispersion variance gamma-frailty either given numeric vector function covariates 'x' extra column 'rate' holding rate parameter 'rate' ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from count model given covariates — outcome_count","text":"data.table added exposure column","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_count.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from count model given covariates — outcome_count","text":"","code":"set.seed(24) covariates <- function(n) data.frame(a = rbinom(n, 1, 0.5)) outcome <- setargs(   outcome_count,   mean = ~ 1 + a,   par = log(c(2.5, 0.65)),   overdispersion = 1 / 2,   exposure = 2 # identical exposure time for all subjects ) trial <- Trial$new(covariates = covariates, outcome = outcome) trial$simulate(5) #>       id     a   num     y exposure #>    <num> <int> <num> <num>    <num> #> 1:     1     0     0     4        2 #> 2:     2     0     0     6        2 #> 3:     3     1     0     0        2 #> 4:     4     1     0     1        2 #> 5:     5     1     0     2        2 # alternating exposure times between subjects trial$args_model(exposure = c(1, 2)) trial$simulate(5) #>       id     a   num     y exposure #>    <num> <int> <num> <num>    <num> #> 1:     1     1     0     6        1 #> 2:     2     0     0     5        2 #> 3:     3     0     0     0        1 #> 4:     4     1     0     3        2 #> 5:     5     0     0     1        1 # treatment-dependent exposure times trial$args_model(exposure = function(dd) 1 - 0.5 * dd$a) trial$simulate(5) #>       id     a   num     y exposure #>    <num> <int> <num> <num>    <num> #> 1:     1     0     0     2      1.0 #> 2:     2     0     0     6      1.0 #> 3:     3     0     0     1      1.0 #> 4:     4     0     0     1      1.0 #> 5:     5     1     0     1      0.5"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_lp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate linear predictor from covariates — outcome_lp","title":"Calculate linear predictor from covariates — outcome_lp","text":"Calculate linear predictor $$\\text{par}^\\top X$$ \\(X\\) design matrix specified formula","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_lp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate linear predictor from covariates — outcome_lp","text":"","code":"outcome_lp(   data,   mean = NULL,   par = NULL,   model = NULL,   offset = NULL,   treatment = NULL,   intercept = TRUE,   default.parameter = 0,   family = gaussian(),   remove = c(\"id\", \"num\"),   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_lp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate linear predictor from covariates — outcome_lp","text":"data covariate matrix mean formula specifying design 'data' function maps x mean value. NULL main-effects covariates used par Regression coefficients (default zero). Can given named list corresponding column names model.matrix model Optional model object (glm, mets::phreg, ...) offset Optional offset variable name treatment Optional name treatment variable intercept FALSE intercept removed design matrix default.parameter model treatment specified, interaction terms treatment covariates model added simulation model. default.parameter specifies default parameter extra parameters can changed individually par argument. family family (default 'gaussian(identity)'). inverse link-function used map mean linear predictor scale (mean given function) remove variables removed input data (formula specified) ... Additional arguments passed lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_lp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate linear predictor from covariates — outcome_lp","text":"data.table","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"Outcome model time--event end-points (proportional hazards)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"","code":"outcome_phreg(   data,   lp = NULL,   par = NULL,   outcome.name = c(\"time\", \"status\"),   remove = c(\"id\", \"num\"),   model = NULL,   cens.model = NULL,   cens.lp = NULL,   cens.par = NULL,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"data data.frame (covariates) lp linear predictor (formula function) par optional list model parameter outcome.name names outcome (time censoring status) remove variables removed input data (formula specified) model optional mets::phreg object cens.model optional model censoring mechanism cens.lp censoring linear predictor argument (formula function) cens.par list censoring model parameters ... Additional arguments outcome_lp","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"function (random generator)","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"Klaus Kähler Holst","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_phreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outcome model for time-to-event end-points (proportional hazards) — outcome_phreg","text":"","code":"library(\"survival\") #>  #> Attaching package: ‘survival’ #> The following object is masked from ‘package:future’: #>  #>     cluster data(pbc, package = \"survival\") pbc0 <- na.omit(pbc) |>   transform(trt = factor(trt, labels = c(\"Active\", \"Placebo\")) |>     relevel(ref = \"Placebo\"))  fit1 <- mets::phreg(Surv(time, status > 0) ~ age + sex * trt, data = pbc0)  covar <- covar_bootstrap(pbc0, subset = c(\"age\", \"sex\")) %join%   function(n, ...) data.frame(trt = sample(pbc0$trt, n, replace = TRUE))  outcome <- setargs(   outcome_phreg,   model = fit1,   par = list(\"trtActive\" = 0) )  xx <- covar(5e3) pbc1 <- outcome(xx) |> cbind(xx) mets::phreg(formula(fit1), data = pbc1) #> Call: #> mets::phreg(formula = formula(fit1), data = pbc1) #>  #>     n events #>  5000   1729 #> coeffients: #>                  Estimate       S.E.    dU^-1/2 P-value #> age             0.0254403  0.0023480  0.0023641  0.0000 #> sexf            0.1898428  0.0964509  0.0942417  0.0490 #> trtActive       0.0231832  0.1233657  0.1225163  0.8509 #> sexf:trtActive -1.0955251  0.1360572  0.1354915  0.0000 #>  #> exp(coeffients): #>                Estimate    2.5%  97.5% #> age             1.02577 1.02106 1.0305 #> sexf            1.20906 1.00080 1.4607 #> trtActive       1.02345 0.80364 1.3034 #> sexf:trtActive  0.33436 0.25610 0.4365 #>    ## Introducing additional interactions fit2 <- mets::phreg(Surv(time, status > 0) ~ age + sex + trt, data = pbc0)  outcome <- setallargs(   outcome_phreg,   model = fit2,   par = list(\"trtActive\" = -.5, \"age:trtActive\" = 0),   treatment = \"trt\",   default.parameter = -0.2 )  xx <- covar(1e4) attr(outcome(xx), \"par\") #>            age           sexf      trtActive  age:trtActive sexf:trtActive  #>     0.02465763    -0.39648365    -0.50000000     0.00000000    -0.20000000  pbc1 <- outcome(xx) |> cbind(xx) mets::phreg(Surv(time, status) ~ (age + sex) * trt, pbc1) #> Call: #> mets::phreg(formula = Surv(time, status) ~ (age + sex) * trt,  #>     data = pbc1) #>  #>      n events #>  10000   3752 #> coeffients: #>                  Estimate       S.E.    dU^-1/2 P-value #> age             0.0223054  0.0019773  0.0019862  0.0000 #> sexf           -0.4395915  0.0589518  0.0578643  0.0000 #> trtActive      -0.4478356  0.2063221  0.2044322  0.0300 #> age:trtActive  -0.0018865  0.0032907  0.0032679  0.5665 #> sexf:trtActive -0.0811949  0.0925068  0.0918015  0.3801 #>  #> exp(coeffients): #>                Estimate    2.5%  97.5% #> age             1.02256 1.01860 1.0265 #> sexf            0.64430 0.57399 0.7232 #> trtActive       0.63901 0.42647 0.9575 #> age:trtActive   0.99812 0.99170 1.0046 #> sexf:trtActive  0.92201 0.76912 1.1053 #>  rm(pbc1, xx)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_recurrent.html","id":null,"dir":"Reference","previous_headings":"","what":"UNDER DEVELOPMENT: Outcome model for recurrent events with terminal events end-points — outcome_recurrent","title":"UNDER DEVELOPMENT: Outcome model for recurrent events with terminal events end-points — outcome_recurrent","text":"function still experimental state interface functionality might change future","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_recurrent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UNDER DEVELOPMENT: Outcome model for recurrent events with terminal events end-points — outcome_recurrent","text":"","code":"outcome_recurrent(   data,   lp = NULL,   par = NULL,   outcome.name = c(\"time\", \"status\"),   remove = c(\"id\", \"num\"),   model = NULL,   death.model = NULL,   death.lp = NULL,   death.par = NULL,   cens.model = NULL,   cens.lp = NULL,   cens.par = NULL,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_recurrent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"UNDER DEVELOPMENT: Outcome model for recurrent events with terminal events end-points — outcome_recurrent","text":"data data.frame (covariates) lp linear predictor (formula function) par optional list model parameter outcome.name names outcome (time censoring status) remove variables removed input data (formula specified) model optional mets::phreg object death.model optional model death (terminal) events death.lp optional death linear predictor argument (formula function) death.par optional list death model parameters cens.model optional model censoring mechanism cens.lp optional censoring linear predictor argument (formula function) cens.par optional list censoring model parameters ... Additional arguments outcome_lp","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/outcome_recurrent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"UNDER DEVELOPMENT: Outcome model for recurrent events with terminal events end-points — outcome_recurrent","text":"function (random generator)","code":""},{"path":[]},{"path":"https://novonordisk-opensource.github.io/carts/reference/rmvn.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate normal distribution function — rmvn","title":"Multivariate normal distribution function — rmvn","text":"Draw random samples multivariate normal distribution variance given correlation matrix.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/rmvn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate normal distribution function — rmvn","text":"","code":"rmvn(n, mean, cor, var = NULL)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/rmvn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate normal distribution function — rmvn","text":"n number samples mean matrix mean values (either 1xp nxp matrix) cor matrix correlation (either 1x((p-1)*p/2) nx((p-1)*p/2) matrix. correlation coefficients must given order R(1,2), R(1,3), ..., R(1,p), R(2,3), ... R(2,p), ... R(,j) entry row column j correlation matrix. var Optional covariance matrix (instead 'cor' argument)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/rmvn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multivariate normal distribution function — rmvn","text":"","code":"rmvn(10, cor = rep(c(-0.999, 0.999), each = 5)) #>             [,1]       [,2] #>  [1,] -0.3245355  0.2939529 #>  [2,] -0.3255257  0.2920364 #>  [3,]  2.5469921 -2.5349382 #>  [4,]  1.4386971 -1.5090096 #>  [5,]  0.4716534 -0.4251629 #>  [6,]  0.7177491  0.6688876 #>  [7,] -0.9533403 -0.9714448 #>  [8,]  0.6248345  0.6399171 #>  [9,]  0.4949735  0.4985090 #> [10,] -1.1714772 -1.1731128"},{"path":"https://novonordisk-opensource.github.io/carts/reference/rnb.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from a negative binomial distribution — rnb","title":"Simulate from a negative binomial distribution — rnb","text":"Parametrized mean (rate) variance. parameters can vector arguments. case mean = variance = c(r1, r2) n = 5, returned vector contains 5 Poisson samples. Three samples drawn Poisson distribution rate r1 (index 1, 3 5 output vector) two Poisson rate r2 (index 2 4).","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/rnb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from a negative binomial distribution — rnb","text":"","code":"rnb(n, mean, variance = mean, gamma.variance = NULL)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/rnb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from a negative binomial distribution — rnb","text":"n Number samples (integer) mean Mean vector (rate parameter) variance Variance vector gamma.variance (optional) poisson-gamma mixture parametrization. Variance (vector) gamma distribution mean 1.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/rnb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from a negative binomial distribution — rnb","text":"Vector n realizations","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/rnb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from a negative binomial distribution — rnb","text":"","code":"with(   data.frame(x = rnb(1e4, mean = 100, var = 500)),   c(mean = mean(x), var = var(x)) ) #> Warning: partial argument match of 'var' to 'variance' #>     mean      var  #>  99.9759 502.9206"},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"Sample estimated parametric covariate model","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"","code":"sample_covar_parametric_model(n, model = NULL, model.path = NULL)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"n Sample size model lava::lvm object estimated coefficients model.path Path dumped model object (RDS file) disk (optional)","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"data.table","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"Benedikt Sommer","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/sample_covar_parametric_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from an estimated parametric covariate model — sample_covar_parametric_model","text":"","code":"data <- data.table::data.table(   x = rnorm(1e3), y = as.factor(rbinom(1e3, size = 1, prob=0.5)) )  m <- estimate_covar_model_full_cond(data) samples <- sample_covar_parametric_model(n=10, model = m) print(head(samples)) #>             x y #> 1  0.06160995 0 #> 2 -0.02622028 0 #> 3  0.32233767 0 #> 4  0.57457928 1 #> 5  0.31681647 1 #> 6 -0.63881117 0"},{"path":"https://novonordisk-opensource.github.io/carts/reference/setargs.html","id":null,"dir":"Reference","previous_headings":"","what":"Set default arguments of a function — setargs","title":"Set default arguments of a function — setargs","text":"Sets default values arguments f. Care taken missing used f (see examples).","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/setargs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set default arguments of a function — setargs","text":"","code":"setargs(f, ..., setargs.warn = TRUE)"},{"path":"https://novonordisk-opensource.github.io/carts/reference/setargs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set default arguments of a function — setargs","text":"f function ... arguments set setargs.warn cast warning trying set default values arguments exist f","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/setargs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Set default arguments of a function — setargs","text":"Benedikt Sommer","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/setargs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set default arguments of a function — setargs","text":"","code":"foo <- function(x, a = 5, ...) {   foo1 <- function(x, b = 5) return(b)   c(a = a, b = foo1(x, ...), x = x) } foo(1) #> a b x  #> 5 5 1   f <- setargs(foo, a = 10) # set new default value for a f(1) #>  a  b  x  #> 10  5  1   # default value of b in lower-level function is unaffected and warning is # cast to inform that b is not an argument in f f <- setargs(foo, b = 10) #> Warning: Argument b not found in function f. f(1) #> a b x  #> 5 5 1  # disable warning message setargs(foo, b = 10, setargs.warn = FALSE)(1) #> a b x  #> 5 5 1   # arguments of lower-level functions can be set with setallargs f <- setallargs(foo, a = 10, b = 10) f(1) #>  a  b  x  #> 10 10  1   # does not work when `missing` checks for missing formal arguments. foo1 <- function(x, a) {   if (missing(a)) a <- 5   return(c(x = x, a = a)) } f <- setargs(foo1, a = 10) #> Warning: `missing` calls not working with `formals` f(1) #> x a  #> 1 5"},{"path":"https://novonordisk-opensource.github.io/carts/reference/summary.trial.estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for simulated trials (trial.estimates objects) — summary.trial.estimates","title":"Summary method for simulated trials (trial.estimates objects) — summary.trial.estimates","text":"Deprecated Summary method Monte Carlo studies different estimators treatment effect randomized clinical trial. Please use Trial$summary() instead.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/summary.trial.estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for simulated trials (trial.estimates objects) — summary.trial.estimates","text":"","code":"# S3 method for class 'trial.estimates' summary(   object,   level = 0.05,   null = 0,   ni.margin = NULL,   alternative = c(\"!=\", \"<\", \">\"),   reject.function = NULL,   true.value = NULL,   nominal.coverage = 0.9,   ... )"},{"path":"https://novonordisk-opensource.github.io/carts/reference/summary.trial.estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for simulated trials (trial.estimates objects) — summary.trial.estimates","text":"object (trial.estimates) level significance level null null hypothesis test ni.margin non-inferiority margin alternative alternative hypothesis (equal !=, less <, greater >) reject.function Optional function calculating whether reject null hypothesis. function one following arguments: estimate (parameter estimate), stderr (Standard error estimate), lower (lower confidence limit), upper (upper confidence limit) true.value Optional true parameter value. provided root-mean square error (RMSE) coverage estimated confidence limits also calculated. nominal.coverage Width confidence limits used calculate empirical coverage around true.value. default value calculates coverage central 90% confidence interval. ... additional arguments lower level functions","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/summary.trial.estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for simulated trials (trial.estimates objects) — summary.trial.estimates","text":"matrix results estimator stored separate rows","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/trial.estimates-class.html","id":null,"dir":"Reference","previous_headings":"","what":"trial.estimates class object — trial.estimates-class","title":"trial.estimates class object — trial.estimates-class","text":"Trial$run() returns S3 class object trial.estimates. object contains information reproduce estimates shown example. object list following components: model Trial object used generate estimates. estimates (list) Estimates Monte-Carlo runs estimators. sample.data (data.table) Sample data returned Trial$simulate(). estimators (list) Estimators applied simulated data Monte-Carlo run. sim.args (list) Arguments passed Trial$simulate() simulating data Monte-Carlo run. R (numeric) Number Monte-Carlo replications.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/trial.estimates-class.html","id":"s-generics","dir":"Reference","previous_headings":"","what":"S3 generics","title":"trial.estimates class object — trial.estimates-class","text":"following S3 generic functions available object class trial.estimates: print Basic print method. summary Apply decision-making estimates run estimator.","code":""},{"path":"https://novonordisk-opensource.github.io/carts/reference/trial.estimates-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"trial.estimates class object — trial.estimates-class","text":"","code":"trial <- Trial$new(   covariates = function(n) data.frame(a = rbinom(n, 1, 0.5)),   outcome = function(data) rnorm(nrow(data), data$a * -1)  ) res <- trial$run(n = 100, R = 10, estimators = est_glm()) print(res) #> ── trial.estimates ──  #>  #> Model arguments:  #> Estimators: est1 #> Simulation parameters: n = 100, R = 10 #>  #> Sample data: #>       id     a   num          y #>    <num> <int> <num>      <num> #> 1:     1     0     0 -2.0169189 #> 2:     2     0     0  1.2316312 #> 3:     3     0     0 -0.8976384 #> 4:     4     0     0  1.1621249 #> 5:     5     1     0 -1.7705241 #> 6:     6     1     0 -2.0515803  # assuming previous estimates have been saved to disk. # load estimates object and repeat simulation with more Monte-Carlo runs res2 <- do.call(   res$model$run,   c(list(R = 20, estimators = res$estimators), res$sim.args) ) print(res2) #> ── trial.estimates ──  #>  #> Model arguments:  #> Estimators: est1 #> Simulation parameters: n = 100, R = 20 #>  #> Sample data: #>       id     a   num          y #>    <num> <int> <num>      <num> #> 1:     1     1     0 -0.7183964 #> 2:     2     1     0 -0.6523919 #> 3:     3     0     0 -1.4753441 #> 4:     4     1     0 -1.2798479 #> 5:     5     0     0 -0.1761558 #> 6:     6     0     0  1.3139075"}]
